import os
import re
import statistics
import time
from copy import deepcopy
from dataclasses import dataclass
from typing import Tuple, Optional

import ffmpeg
import requests
import soundfile as sf
import torch
import whisper
import whisperx
from dataclasses_json import dataclass_json
from whisper.audio import SAMPLE_RATE

# from asr import transcribe_with_vad
# from triton.python.whisperX.whisperx import load_vad_model

CLEAN_TEXT_REGEX = re.compile("[^a-zA-Z0-9\s]")

data = {
    "segments": [
        {
            "id": 0,
            "seek": 0,
            "start": 0.0,
            "end": 13.0,
            "text": " Told you not to worry But maybe that's a lie",
            "tokens": [
                50364,
                48220,
                291,
                406,
                281,
                3292,
                583,
                1310,
                300,
                311,
                257,
                4544,
                51014,
            ],
            "temperature": 0.0,
            "avg_logprob": -0.4792216618855794,
            "compression_ratio": 1.0689655172413792,
            "no_speech_prob": 0.5666754245758057,
            "seg-text": [" Told you not to worry But maybe that's a lie"],
        },
        {
            "id": 1,
            "seek": 0,
            "start": 13.0,
            "end": 21.0,
            "text": " Honey, what's your hurry? Won't you stay inside?",
            "tokens": [
                51014,
                16187,
                11,
                437,
                311,
                428,
                11025,
                30,
                14710,
                380,
                291,
                1754,
                1854,
                30,
                51414,
            ],
            "temperature": 0.0,
            "avg_logprob": -0.4792216618855794,
            "compression_ratio": 1.0689655172413792,
            "no_speech_prob": 0.5666754245758057,
            "seg-text": [" Honey, what's your hurry? Won't you stay inside?"],
        },
        {
            "id": 2,
            "seek": 2100,
            "start": 22.0,
            "end": 32.0,
            "text": " Remember not to get too close to stars They're never gonna give you love like ours",
            "tokens": [
                50414,
                5459,
                406,
                281,
                483,
                886,
                1998,
                281,
                6105,
                814,
                434,
                1128,
                799,
                976,
                291,
                959,
                411,
                11896,
                50914,
            ],
            "temperature": 0.0,
            "avg_logprob": -0.23136209619456324,
            "compression_ratio": 1.3774834437086092,
            "no_speech_prob": 0.09686321020126343,
            "seg-text": [
                " Remember not to get too close to stars They're never gonna give you love like ours"
            ],
        },
        {
            "id": 3,
            "seek": 2100,
            "start": 32.0,
            "end": 41.0,
            "text": " Where did you go? I should know, but it's cold And I don't wanna be lonely, so show me the way home",
            "tokens": [
                50914,
                2305,
                630,
                291,
                352,
                30,
                286,
                820,
                458,
                11,
                457,
                309,
                311,
                3554,
                400,
                286,
                500,
                380,
                1948,
                312,
                14236,
                11,
                370,
                855,
                385,
                264,
                636,
                1280,
                51364,
            ],
            "temperature": 0.0,
            "avg_logprob": -0.23136209619456324,
            "compression_ratio": 1.3774834437086092,
            "no_speech_prob": 0.09686321020126343,
            "seg-text": [
                " Where did you go? I should know, but it's cold And I don't wanna be lonely, so show me the way home"
            ],
        },
        {
            "id": 4,
            "seek": 2100,
            "start": 42.0,
            "end": 46.0,
            "text": " I can't lose another life",
            "tokens": [51414, 286, 393, 380, 3624, 1071, 993, 51614],
            "temperature": 0.0,
            "avg_logprob": -0.23136209619456324,
            "compression_ratio": 1.3774834437086092,
            "no_speech_prob": 0.09686321020126343,
            "seg-text": [" I can't lose another life"],
        },
        {
            "id": 5,
            "seek": 4600,
            "start": 47.0,
            "end": 55.0,
            "text": " Blurry",
            "tokens": [50414, 2177, 30614, 50814],
            "temperature": 0.0,
            "avg_logprob": -0.2457843508039202,
            "compression_ratio": 1.1827956989247312,
            "no_speech_prob": 0.0431845523416996,
            "seg-text": [" Blurry"],
        },
        {
            "id": 6,
            "seek": 4600,
            "start": 55.0,
            "end": 62.0,
            "text": " The world's a little blurry Or maybe it's my eyes",
            "tokens": [
                50814,
                440,
                1002,
                311,
                257,
                707,
                37644,
                1610,
                1310,
                309,
                311,
                452,
                2575,
                51164,
            ],
            "temperature": 0.0,
            "avg_logprob": -0.2457843508039202,
            "compression_ratio": 1.1827956989247312,
            "no_speech_prob": 0.0431845523416996,
            "seg-text": [" The world's a little blurry Or maybe it's my eyes"],
        },
        {
            "id": 7,
            "seek": 4600,
            "start": 62.0,
            "end": 70.0,
            "text": " The friends I've had to bury They keep me up at night",
            "tokens": [
                51164,
                440,
                1855,
                286,
                600,
                632,
                281,
                28919,
                814,
                1066,
                385,
                493,
                412,
                1818,
                51564,
            ],
            "temperature": 0.0,
            "avg_logprob": -0.2457843508039202,
            "compression_ratio": 1.1827956989247312,
            "no_speech_prob": 0.0431845523416996,
            "seg-text": [" The friends I've had to bury They keep me up at night"],
        },
        {
            "id": 8,
            "seek": 7000,
            "start": 70.0,
            "end": 75.0,
            "text": " Said I couldn't love someone Cause I might break",
            "tokens": [
                50364,
                26490,
                286,
                2809,
                380,
                959,
                1580,
                10865,
                286,
                1062,
                1821,
                50614,
            ],
            "temperature": 0.0,
            "avg_logprob": -0.1832580268383026,
            "compression_ratio": 1.3459119496855345,
            "no_speech_prob": 0.1385020762681961,
            "seg-text": [" Said I couldn't love someone Cause I might break"],
        },
        {
            "id": 9,
            "seek": 7000,
            "start": 75.0,
            "end": 79.0,
            "text": " If you're gonna die Not by mistake",
            "tokens": [50614, 759, 291, 434, 799, 978, 1726, 538, 6146, 50814],
            "temperature": 0.0,
            "avg_logprob": -0.1832580268383026,
            "compression_ratio": 1.3459119496855345,
            "no_speech_prob": 0.1385020762681961,
            "seg-text": [" If you're gonna die Not by mistake"],
        },
        {
            "id": 10,
            "seek": 7000,
            "start": 79.0,
            "end": 89.0,
            "text": " So where did you go? I should know, but it's cold And I don't wanna be lonely, so tell me you'll come home",
            "tokens": [
                50814,
                407,
                689,
                630,
                291,
                352,
                30,
                286,
                820,
                458,
                11,
                457,
                309,
                311,
                3554,
                400,
                286,
                500,
                380,
                1948,
                312,
                14236,
                11,
                370,
                980,
                385,
                291,
                603,
                808,
                1280,
                51314,
            ],
            "temperature": 0.0,
            "avg_logprob": -0.1832580268383026,
            "compression_ratio": 1.3459119496855345,
            "no_speech_prob": 0.1385020762681961,
            "seg-text": [
                " So where did you go? I should know, but it's cold And I don't wanna be lonely, so tell me you'll come home"
            ],
        },
        {
            "id": 11,
            "seek": 7000,
            "start": 90.0,
            "end": 93.0,
            "text": " Even if it's just a lie",
            "tokens": [51364, 2754, 498, 309, 311, 445, 257, 4544, 51514],
            "temperature": 0.0,
            "avg_logprob": -0.1832580268383026,
            "compression_ratio": 1.3459119496855345,
            "no_speech_prob": 0.1385020762681961,
            "seg-text": [" Even if it's just a lie"],
        },
        {
            "id": 12,
            "seek": 9300,
            "start": 94.0,
            "end": 101.0,
            "text": " I tried not to upset you, let you rescue me the day I met you",
            "tokens": [
                50414,
                286,
                3031,
                406,
                281,
                8340,
                291,
                11,
                718,
                291,
                13283,
                385,
                264,
                786,
                286,
                1131,
                291,
                50764,
            ],
            "temperature": 0.0,
            "avg_logprob": -0.27327464875720797,
            "compression_ratio": 1.3,
            "no_speech_prob": 0.13215813040733337,
            "seg-text": [
                " I tried not to upset you, let you rescue me the day I met you"
            ],
        },
        {
            "id": 13,
            "seek": 9300,
            "start": 101.0,
            "end": 109.0,
            "text": " I just wanted to protect you But now I'll never get to",
            "tokens": [
                50764,
                286,
                445,
                1415,
                281,
                2371,
                291,
                583,
                586,
                286,
                603,
                1128,
                483,
                281,
                51164,
            ],
            "temperature": 0.0,
            "avg_logprob": -0.27327464875720797,
            "compression_ratio": 1.3,
            "no_speech_prob": 0.13215813040733337,
            "seg-text": [" I just wanted to protect you But now I'll never get to"],
        },
        {
            "id": 14,
            "seek": 9300,
            "start": 112.0,
            "end": 115.0,
            "text": " Blurry",
            "tokens": [51314, 2177, 30614, 51464],
            "temperature": 0.0,
            "avg_logprob": -0.27327464875720797,
            "compression_ratio": 1.3,
            "no_speech_prob": 0.13215813040733337,
            "seg-text": [" Blurry"],
        },
        {
            "id": 15,
            "seek": 9300,
            "start": 115.0,
            "end": 119.0,
            "text": " Blurry",
            "tokens": [51464, 2177, 30614, 51664],
            "temperature": 0.0,
            "avg_logprob": -0.27327464875720797,
            "compression_ratio": 1.3,
            "no_speech_prob": 0.13215813040733337,
            "seg-text": [" Blurry"],
        },
        {
            "id": 16,
            "seek": 12300,
            "start": 123.0,
            "end": 137.0,
            "text": " Where did you go? I should know, but it's cold And I don't wanna be lonely, so tell me you'll come home",
            "tokens": [
                50364,
                2305,
                630,
                291,
                352,
                30,
                286,
                820,
                458,
                11,
                457,
                309,
                311,
                3554,
                400,
                286,
                500,
                380,
                1948,
                312,
                14236,
                11,
                370,
                980,
                385,
                291,
                603,
                808,
                1280,
                51064,
            ],
            "temperature": 0.0,
            "avg_logprob": -0.21699255988711402,
            "compression_ratio": 1.2037037037037037,
            "no_speech_prob": 0.04957237094640732,
            "seg-text": [
                " Where did you go? I should know, but it's cold And I don't wanna be lonely, so tell me you'll come home"
            ],
        },
        {
            "id": 17,
            "seek": 12300,
            "start": 138.0,
            "end": 142.0,
            "text": " I don't care if it's a lie",
            "tokens": [51114, 286, 500, 380, 1127, 498, 309, 311, 257, 4544, 51314],
            "temperature": 0.0,
            "avg_logprob": -0.21699255988711402,
            "compression_ratio": 1.2037037037037037,
            "no_speech_prob": 0.04957237094640732,
            "seg-text": [" I don't care if it's a lie"],
        },
        {
            "id": 18,
            "seek": 15300,
            "start": 153.0,
            "end": 156.0,
            "text": " Blurry",
            "tokens": [50364, 2177, 30614, 50514],
            "temperature": 0.0,
            "avg_logprob": -0.771566915512085,
            "compression_ratio": 0.42857142857142855,
            "no_speech_prob": 0.9925419092178345,
            "seg-text": [" Blurry"],
        },
    ],
    "words": [
        {"text": "Told", "start": 7.551617873651772, "end": 7.7919876733436055},
        {"text": "you", "start": 7.812018489984592, "end": 8.03235747303544},
        {"text": "not", "start": 8.072419106317412, "end": 8.332819722650232},
        {"text": "to", "start": 8.352850539291216, "end": 8.513097072419106},
        {"text": "worry", "start": 8.553158705701078, "end": 8.953775038520801},
        {"text": "But", "start": 11.317411402157164, "end": 11.477657935285054},
        {"text": "maybe", "start": 11.557781201848998, "end": 11.998459167950694},
        {"text": "that's", "start": 12.058551617873652, "end": 12.338983050847457},
        {"text": "a", "start": 12.459167950693374, "end": 12.559322033898304},
        {"text": "lie", "start": 12.57935285053929, "end": 12.879815100154083},
        {"text": "Honey,", "start": 15.546365914786968, "end": 15.987468671679197},
        {"text": "what's", "start": 16.027568922305765, "end": 16.288220551378444},
        {"text": "your", "start": 16.328320802005013, "end": 16.48872180451128},
        {"text": "hurry?", "start": 16.548872180451127, "end": 16.949874686716793},
        {"text": "Won't", "start": 19.55639097744361, "end": 19.796992481203006},
        {"text": "you", "start": 19.83709273182957, "end": 19.977443609022558},
        {"text": "stay", "start": 19.99749373433584, "end": 20.278195488721806},
        {"text": "inside?", "start": 20.29824561403509, "end": 20.91979949874687},
        {"text": "Remember", "start": 23.322645290581164, "end": 24.004008016032063},
        {"text": "not", "start": 24.044088176352705, "end": 24.26452905811623},
        {"text": "to", "start": 24.304609218436873, "end": 24.505010020040082},
        {"text": "get", "start": 24.56513026052104, "end": 24.86573146292585},
        {"text": "too", "start": 25.246492985971944, "end": 25.48697394789579},
        {"text": "close", "start": 25.547094188376754, "end": 25.987975951903806},
        {"text": "to", "start": 26.228456913827657, "end": 26.428857715430862},
        {"text": "stars", "start": 26.468937875751504, "end": 27.03006012024048},
        {"text": "They're", "start": 27.27054108216433, "end": 27.490981963927855},
        {"text": "never", "start": 27.551102204408817, "end": 27.991983967935873},
        {"text": "gonna", "start": 28.052104208416832, "end": 28.472945891783567},
        {"text": "give", "start": 28.55310621242485, "end": 28.8937875751503},
        {"text": "you", "start": 29.334669338677354, "end": 29.51503006012024},
        {"text": "love", "start": 29.5751503006012, "end": 29.895791583166332},
        {"text": "like", "start": 30.316633266533067, "end": 30.557114228456914},
        {"text": "ours", "start": 30.857715430861724, "end": 31.478957915831664},
        {"text": "Where", "start": 32.54120267260579, "end": 32.78173719376392},
        {"text": "did", "start": 32.801781737193764, "end": 32.98218262806236},
        {"text": "you", "start": 33.042316258351896, "end": 33.22271714922049},
        {"text": "go?", "start": 33.30289532293987, "end": 33.66369710467706},
        {"text": "I", "start": 33.6837416481069, "end": 33.70378619153675},
        {"text": "should", "start": 33.944320712694875, "end": 34.204899777282854},
        {"text": "know,", "start": 34.28507795100223, "end": 34.665924276169264},
        {"text": "but", "start": 34.78619153674833, "end": 35.00668151447662},
        {"text": "it's", "start": 35.08685968819599, "end": 35.24721603563474},
        {"text": "cold", "start": 35.347438752783965, "end": 35.84855233853007},
        {"text": "And", "start": 35.928730512249444, "end": 36.02895322939867},
        {"text": "I", "start": 36.16926503340757, "end": 36.28953229398664},
        {"text": "don't", "start": 36.329621380846326, "end": 36.57015590200446},
        {"text": "wanna", "start": 36.610244988864146, "end": 36.87082405345212},
        {"text": "be", "start": 37.051224944320715, "end": 37.271714922049},
        {"text": "lonely,", "start": 37.33184855233853, "end": 37.953229398663694},
        {"text": "so", "start": 37.99331848552339, "end": 38.213808463251674},
        {"text": "show", "start": 38.25389755011136, "end": 38.775055679287306},
        {"text": "me", "start": 38.79510022271715, "end": 38.9554565701559},
        {"text": "the", "start": 39.03563474387528, "end": 39.23608017817372},
        {"text": "way", "start": 39.27616926503341, "end": 39.71714922048998},
        {"text": "home", "start": 40.037861915367486, "end": 40.41870824053452},
        {"text": "I", "start": 43.12562814070352, "end": 43.185929648241206},
        {"text": "can't", "start": 43.266331658291456, "end": 43.527638190954775},
        {"text": "lose", "start": 43.5678391959799, "end": 43.92964824120603},
        {"text": "another", "start": 44.01005025125628, "end": 44.45226130653266},
        {"text": "life", "start": 44.57286432160804, "end": 44.97487437185929},
        {"text": "Blurry", "start": 48.54385964912281, "end": 48.764411027568926},
        {"text": "The", "start": 55.260744985673355, "end": 55.46131805157593},
        {"text": "world's", "start": 55.50143266475645, "end": 55.84240687679083},
        {"text": "a", "start": 55.92263610315186, "end": 56.04297994269341},
        {"text": "little", "start": 56.10315186246418, "end": 56.383954154727796},
        {"text": "blurry", "start": 56.54441260744986, "end": 57.04584527220631},
        {"text": "Or", "start": 59.372492836676216, "end": 59.49283667621776},
        {"text": "maybe", "start": 59.532951289398284, "end": 60.03438395415473},
        {"text": "it's", "start": 60.13467048710602, "end": 60.315186246418335},
        {"text": "my", "start": 60.39541547277937, "end": 60.59598853868195},
        {"text": "eyes", "start": 60.75644699140401, "end": 60.93696275071633},
        {"text": "The", "start": 63.283208020050125, "end": 63.44360902255639},
        {"text": "friends", "start": 63.50375939849624, "end": 63.80451127819549},
        {"text": "I've", "start": 63.86466165413534, "end": 64.02506265664161},
        {"text": "had", "start": 64.06516290726817, "end": 64.24561403508773},
        {"text": "to", "start": 64.28571428571429, "end": 64.42606516290726},
        {"text": "bury", "start": 64.52631578947368, "end": 64.9874686716792},
        {"text": "They", "start": 65.04761904761905, "end": 65.48872180451127},
        {"text": "keep", "start": 65.54887218045113, "end": 66.31077694235589},
        {"text": "me", "start": 66.33082706766918, "end": 66.47117794486215},
        {"text": "up", "start": 66.67167919799499, "end": 66.79197994987469},
        {"text": "at", "start": 66.91228070175438, "end": 66.97243107769424},
        {"text": "night", "start": 67.03258145363408, "end": 67.31328320802005},
        {"text": "Said", "start": 70.96385542168674, "end": 71.285140562249},
        {"text": "I", "start": 71.36546184738955, "end": 71.46586345381526},
        {"text": "couldn't", "start": 71.54618473895583, "end": 72.0281124497992},
        {"text": "love", "start": 72.06827309236948, "end": 72.30923694779116},
        {"text": "someone", "start": 72.34939759036145, "end": 72.83132530120481},
        {"text": "Cause", "start": 72.85140562248996, "end": 73.89558232931726},
        {"text": "I", "start": 73.91566265060241, "end": 73.93574297188755},
        {"text": "might", "start": 74.31726907630522, "end": 74.51807228915662},
        {"text": "break", "start": 74.61847389558233, "end": 74.95983935742971},
        {"text": "If", "start": 75.64321608040201, "end": 75.78391959798995},
        {"text": "you're", "start": 75.82412060301507, "end": 76.00502512562814},
        {"text": "gonna", "start": 76.06532663316582, "end": 76.48743718592965},
        {"text": "die", "start": 76.5678391959799, "end": 76.8894472361809},
        {"text": "Not", "start": 77.29145728643216, "end": 77.49246231155779},
        {"text": "by", "start": 77.57286432160804, "end": 77.93467336683418},
        {"text": "mistake", "start": 78.2964824120603, "end": 78.91959798994975},
        {"text": "So", "start": 79.98196392785572, "end": 80.44288577154309},
        {"text": "where", "start": 80.56312625250501, "end": 80.78356713426854},
        {"text": "did", "start": 80.80360721442885, "end": 80.98396793587175},
        {"text": "you", "start": 81.02404809619239, "end": 81.2244488977956},
        {"text": "go?", "start": 81.28456913827655, "end": 81.72545090180361},
        {"text": "I", "start": 81.86573146292585, "end": 81.9258517034068},
        {"text": "should", "start": 81.96593186372745, "end": 82.24649298597194},
        {"text": "know,", "start": 82.28657314629258, "end": 82.687374749499},
        {"text": "but", "start": 82.80761523046093, "end": 83.02805611222445},
        {"text": "it's", "start": 83.0881763527054, "end": 83.24849699398797},
        {"text": "cold", "start": 83.34869739478958, "end": 83.82965931863727},
        {"text": "And", "start": 83.92985971943888, "end": 84.0501002004008},
        {"text": "I", "start": 84.21042084168337, "end": 84.27054108216433},
        {"text": "don't", "start": 84.33066132264528, "end": 84.53106212424849},
        {"text": "wanna", "start": 84.59118236472946, "end": 85.0120240480962},
        {"text": "be", "start": 85.07214428857715, "end": 85.27254509018036},
        {"text": "lonely,", "start": 85.33266533066133, "end": 85.95390781563127},
        {"text": "so", "start": 85.99398797595191, "end": 86.21442885771543},
        {"text": "tell", "start": 86.29458917835672, "end": 86.73547094188376},
        {"text": "me", "start": 86.81563126252505, "end": 87.01603206412825},
        {"text": "you'll", "start": 87.0561122244489, "end": 87.2565130260521},
        {"text": "come", "start": 87.33667334669339, "end": 87.77755511022045},
        {"text": "home", "start": 88.03807615230461, "end": 88.39879759519039},
        {"text": "Even", "start": 91.16778523489933, "end": 91.51006711409396},
        {"text": "if", "start": 91.6510067114094, "end": 91.77181208053692},
        {"text": "it's", "start": 91.87248322147651, "end": 91.99328859060402},
        {"text": "just", "start": 92.03355704697987, "end": 92.35570469798658},
        {"text": "a", "start": 92.47651006711409, "end": 92.59731543624162},
        {"text": "lie", "start": 92.61744966442953, "end": 92.8993288590604},
        {"text": "I", "start": 95.34383954154728, "end": 95.46418338108883},
        {"text": "tried", "start": 95.50429799426934, "end": 95.76504297994269},
        {"text": "not", "start": 95.80515759312321, "end": 96.02578796561605},
        {"text": "to", "start": 96.04584527220631, "end": 96.34670487106017},
        {"text": "upset", "start": 96.36676217765043, "end": 96.98853868194843},
        {"text": "you,", "start": 97.0487106017192, "end": 97.36962750716333},
        {"text": "let", "start": 97.5702005730659, "end": 98.01146131805157},
        {"text": "you", "start": 98.07163323782235, "end": 98.39255014326648},
        {"text": "rescue", "start": 98.59312320916905, "end": 99.39541547277938},
        {"text": "me", "start": 99.51575931232092, "end": 99.73638968481376},
        {"text": "the", "start": 99.79656160458453, "end": 99.97707736389685},
        {"text": "day", "start": 100.05730659025788, "end": 100.3381088825215},
        {"text": "I", "start": 100.41833810888252, "end": 100.51862464183381},
        {"text": "met", "start": 100.59885386819484, "end": 100.87965616045845},
        {"text": "you", "start": 100.91977077363897, "end": 100.97994269340974},
        {"text": "I", "start": 101.80200501253132, "end": 102.04260651629073},
        {"text": "just", "start": 102.0827067669173, "end": 102.36340852130326},
        {"text": "wanted", "start": 102.52380952380952, "end": 103.44611528822055},
        {"text": "to", "start": 103.52631578947368, "end": 104.00751879699249},
        {"text": "protect", "start": 104.08771929824562, "end": 105.41102756892231},
        {"text": "you", "start": 105.51127819548873, "end": 106.47368421052632},
        {"text": "But", "start": 107.3157894736842, "end": 107.49624060150376},
        {"text": "now", "start": 107.57644110275689, "end": 107.8170426065163},
        {"text": "I'll", "start": 107.9172932330827, "end": 108.05764411027569},
        {"text": "never", "start": 108.11779448621554, "end": 108.47869674185463},
        {"text": "get", "start": 108.57894736842105, "end": 108.81954887218045},
        {"text": "to", "start": 108.83959899749374, "end": 108.89974937343358},
        {"text": "Blurry", "start": 112.56375838926175, "end": 112.88590604026845},
        {"text": "Blurry", "start": 115.08040201005025, "end": 115.28140703517587},
        {"text": "Where", "start": 128.52789699570815, "end": 128.78826895565092},
        {"text": "did", "start": 128.8082975679542, "end": 129.0286123032904},
        {"text": "you", "start": 129.0486409155937, "end": 129.10872675250357},
        {"text": "go?", "start": 129.24892703862662, "end": 129.72961373390558},
        {"text": "I", "start": 129.74964234620887, "end": 129.76967095851217},
        {"text": "should", "start": 129.98998569384835, "end": 130.25035765379113},
        {"text": "know,", "start": 130.2904148783977, "end": 130.69098712446353},
        {"text": "but", "start": 130.79113018597997, "end": 131.03147353361945},
        {"text": "it's", "start": 131.09155937052932, "end": 131.25178826895564},
        {"text": "cold", "start": 131.3118741058655, "end": 131.75250357653792},
        {"text": "And", "start": 131.87267525035764, "end": 131.9928469241774},
        {"text": "I", "start": 132.1530758226037, "end": 132.27324749642347},
        {"text": "don't", "start": 132.31330472103005, "end": 132.793991416309},
        {"text": "wanna", "start": 132.8140200286123, "end": 132.91416309012877},
        {"text": "be", "start": 133.05436337625179, "end": 133.21459227467813},
        {"text": "lonely,", "start": 133.27467811158797, "end": 134.03576537911303},
        {"text": "so", "start": 134.23605150214593, "end": 134.6967095851216},
        {"text": "tell", "start": 134.7167381974249, "end": 134.89699570815452},
        {"text": "me", "start": 134.91702432045778, "end": 135.01716738197425},
        {"text": "you'll", "start": 135.05722460658083, "end": 135.21745350500714},
        {"text": "come", "start": 135.3376251788269, "end": 135.7381974248927},
        {"text": "home", "start": 136.03862660944205, "end": 136.41917024320458},
        {"text": "I", "start": 139.1859296482412, "end": 139.2462311557789},
        {"text": "don't", "start": 139.28643216080403, "end": 139.5075376884422},
        {"text": "care", "start": 139.58793969849245, "end": 140.13065326633165},
        {"text": "if", "start": 140.23115577889448, "end": 140.33165829145727},
        {"text": "it's", "start": 140.51256281407035, "end": 140.7537688442211},
        {"text": "a", "start": 140.95477386934672, "end": 141.03517587939697},
        {"text": "lie", "start": 141.0753768844221, "end": 141.39698492462313},
        {"text": "Blurry", "start": 153.0, "end": 153.1208053691275},
    ],
}
whisper_lyrics_data = {
    "lines": [
        {
            "words": [
                {"text": "Told", "start": 7.544082694697598, "end": 7.804170205053853},
                {"text": "you", "start": 7.824176936619718, "end": 8.024244252278377},
                {"text": "not", "start": 8.064257715410108, "end": 8.304338494200497},
                {"text": "to", "start": 8.34435195733223, "end": 8.504405809859156},
                {"text": "worry", "start": 8.544419272990886, "end": 8.924547172742336},
            ],
            "start": 7.544082694697598,
            "end": 8.924547172742336,
        },
        {
            "words": [
                {"text": "But", "start": 11.305348229080366, "end": 11.485408813173157},
                {
                    "text": "maybe",
                    "start": 11.545429007870755,
                    "end": 11.965570370753936,
                },
                {
                    "text": "that's",
                    "start": 12.045597297017398,
                    "end": 12.32569153893952,
                },
                {"text": "a", "start": 12.425725196768848, "end": 12.545765586164045},
                {"text": "lie", "start": 12.565772317729909, "end": 12.905886754349627},
            ],
            "start": 11.305348229080366,
            "end": 12.905886754349627,
        },
        {
            "words": [
                {
                    "text": "Honey,",
                    "start": 15.526768589478046,
                    "end": 15.986923415492958,
                },
                {
                    "text": "what's",
                    "start": 16.02693687862469,
                    "end": 16.287024388980946,
                },
                {"text": "your", "start": 16.30703112054681, "end": 16.46708497307374},
                {
                    "text": "hurry?",
                    "start": 16.547111899337203,
                    "end": 16.947246530654517,
                },
            ],
            "start": 15.526768589478046,
            "end": 16.947246530654517,
        },
        {
            "words": [
                {
                    "text": "Won't",
                    "start": 19.54812163421707,
                    "end": 19.788202413007458,
                },
                {"text": "you", "start": 19.808209144573325, "end": 19.948256265534383},
                {
                    "text": "stay",
                    "start": 19.988269728666115,
                    "end": 20.288370702154104,
                },
                {
                    "text": "inside?",
                    "start": 20.368397628417565,
                    "end": 21.088639964788733,
                },
            ],
            "start": 19.54812163421707,
            "end": 21.088639964788733,
        },
        {
            "words": [
                {
                    "text": "Remember",
                    "start": 23.309387168599834,
                    "end": 24.009622773405138,
                },
                {"text": "not", "start": 24.04963623653687, "end": 24.32973047845899},
                {"text": "to", "start": 24.369743941590723, "end": 24.509791062551784},
                {"text": "get", "start": 24.56981125724938, "end": 24.849905499171502},
                {"text": "too", "start": 25.250040130488816, "end": 25.47011417771334},
                {
                    "text": "close",
                    "start": 25.550141103976802,
                    "end": 25.970282466859985,
                },
                {"text": "to", "start": 26.23036997721624, "end": 26.4304372928749},
                {"text": "stars", "start": 26.47045075600663, "end": 27.03063923985087},
            ],
            "start": 23.309387168599834,
            "end": 27.03063923985087,
        },
        {
            "words": [
                {
                    "text": "They're",
                    "start": 27.27072001864126,
                    "end": 27.490794065865785,
                },
                {
                    "text": "never",
                    "start": 27.55081426056338,
                    "end": 27.990962355012428,
                },
                {
                    "text": "gonna",
                    "start": 28.050982549710028,
                    "end": 28.491130644159075,
                },
                {"text": "give", "start": 28.55115083885667, "end": 28.89126527547639},
                {"text": "you", "start": 29.31140663835957, "end": 29.51147395401823},
                {"text": "love", "start": 29.571494148715825, "end": 29.89160185376968},
                {"text": "like", "start": 30.31174321665286, "end": 30.55182399544325},
                {
                    "text": "ours",
                    "start": 30.851924968931236,
                    "end": 31.472133647473076,
                },
            ],
            "start": 27.27072001864126,
            "end": 31.472133647473076,
        },
        {
            "words": [
                {
                    "text": "Where",
                    "start": 32.55598466981132,
                    "end": 32.796126179245285,
                },
                {"text": "did", "start": 32.81613797169811, "end": 32.95622051886792},
                {"text": "you", "start": 32.996244103773584, "end": 33.21637382075472},
                {"text": "go?", "start": 33.31643278301887, "end": 33.756692216981136},
                {"text": "I", "start": 33.89677476415095, "end": 33.97682193396226},
                {"text": "should", "start": 33.9968337264151, "end": 34.23697523584906},
                {"text": "know", "start": 34.27699882075472, "end": 34.697246462264154},
            ],
            "start": 32.55598466981132,
            "end": 34.697246462264154,
        },
        {
            "words": [
                {"text": "But", "start": 34.77729363207547, "end": 34.997423349056604},
                {"text": "it's", "start": 35.09748231132075, "end": 35.237564858490565},
                {"text": "cold", "start": 35.337623820754715, "end": 35.83791863207547},
                {"text": "and", "start": 35.917965801886794, "end": 36.018024764150944},
                {"text": "I", "start": 36.17811910377358, "end": 36.29818985849057},
                {
                    "text": "don't",
                    "start": 36.33821344339623,
                    "end": 36.838508254716984,
                },
                {"text": "wanna", "start": 36.85852004716981, "end": 36.95857900943396},
                {"text": "be", "start": 37.038626179245284, "end": 37.25875589622642},
                {
                    "text": "lonely",
                    "start": 37.29877948113207,
                    "end": 37.93915683962264,
                },
            ],
            "start": 34.77729363207547,
            "end": 37.93915683962264,
        },
        {
            "words": [
                {"text": "So", "start": 37.9791804245283, "end": 38.199310141509436},
                {"text": "show", "start": 38.259345518867924, "end": 38.75964033018868},
                {"text": "me", "start": 38.77965212264151, "end": 38.95975825471698},
                {"text": "the", "start": 39.0398054245283, "end": 39.219911556603776},
                {"text": "way", "start": 39.25993514150944, "end": 39.82026533018868},
                {"text": "home", "start": 40.04039504716981, "end": 40.440630896226416},
            ],
            "start": 37.9791804245283,
            "end": 40.440630896226416,
        },
        {
            "words": [
                {"text": "I", "start": 43.10219929245283, "end": 43.20225825471698},
                {"text": "can't", "start": 43.2823054245283, "end": 43.522446933962264},
                {"text": "lose", "start": 43.562470518867926, "end": 43.90267099056604},
                {
                    "text": "another",
                    "start": 44.002729952830194,
                    "end": 44.442989386792455,
                },
                {"text": "life", "start": 44.56306014150944, "end": 45.02333136792453},
            ],
            "start": 43.10219929245283,
            "end": 45.02333136792453,
        },
        {
            "words": [
                {"text": "The", "start": 48.56541863207548, "end": 48.685489386792455},
                {
                    "text": "world's",
                    "start": 48.70550117924529,
                    "end": 48.925630896226416,
                },
                {"text": "a", "start": 49.00567806603774, "end": 49.06571344339623},
                {
                    "text": "little",
                    "start": 49.085725235849054,
                    "end": 49.42592570754717,
                },
                {"text": "blurry", "start": 49.4459375, "end": 49.92622051886792},
            ],
            "start": 48.56541863207548,
            "end": 49.92622051886792,
        },
        {
            "words": [
                {"text": "Or", "start": 50.006267688679245, "end": 50.06630306603773},
                {"text": "maybe", "start": 50.08631485849057, "end": 50.3064445754717},
                {"text": "it's", "start": 50.5065625, "end": 50.80673938679246},
                {"text": "my", "start": 50.826751179245285, "end": 50.94682193396227},
                {"text": "eyes", "start": 51.00685731132076, "end": 51.32704599056604},
            ],
            "start": 50.006267688679245,
            "end": 51.32704599056604,
        },
        {
            "words": [
                {"text": "My", "start": 63.39093750000001, "end": 63.43095015182187},
                {
                    "text": "friends",
                    "start": 63.490969129554664,
                    "end": 63.81107034412956,
                },
                {"text": "I've", "start": 63.87108932186236, "end": 64.0311399291498},
                {"text": "had", "start": 64.07115258097167, "end": 64.25120951417004},
                {"text": "to", "start": 64.29122216599191, "end": 64.4112601214575},
                {"text": "bury,", "start": 64.53129807692308, "end": 64.97143724696357},
                {"text": "bury,", "start": 65.03145622469636, "end": 65.47159539473685},
                {"text": "bury,", "start": 65.53161437246965, "end": 65.9517472165992},
                {"text": "bury,", "start": 66.03177252024292, "end": 66.45190536437248},
                {"text": "bury,", "start": 66.5319306680162, "end": 66.93205718623483},
                {"text": "bury", "start": 67.03208881578948, "end": 67.21214574898787},
            ],
            "start": 63.39093750000001,
            "end": 67.21214574898787,
        },
        {
            "words": [
                {"text": "They", "start": 67.27216472672066, "end": 67.45222165991903},
                {"text": "keep", "start": 67.5522532894737, "end": 67.89236082995951},
                {"text": "me", "start": 67.93237348178138, "end": 68.11243041497977},
                {"text": "up", "start": 68.19245571862349, "end": 68.29248734817814},
                {"text": "at", "start": 68.43253162955466, "end": 68.53256325910932},
                {"text": "night,", "start": 68.5925822368421, "end": 69.0327214068826},
                {"text": "night,", "start": 69.0927403846154, "end": 69.37282894736843},
                {
                    "text": "night,",
                    "start": 69.39283527327936,
                    "end": 69.53287955465588,
                },
                {
                    "text": "night,",
                    "start": 69.59289853238867,
                    "end": 70.01303137651823,
                },
                {
                    "text": "night,",
                    "start": 70.11306300607288,
                    "end": 70.53319585020243,
                },
                {"text": "night", "start": 70.59321482793523, "end": 70.8332907388664},
            ],
            "start": 67.27216472672066,
            "end": 70.8332907388664,
        },
        {
            "words": [
                {"text": "Said", "start": 70.97333502024291, "end": 71.29343623481782},
                {"text": "I", "start": 71.37346153846154, "end": 71.4734931680162},
                {
                    "text": "couldn't",
                    "start": 71.55351847165993,
                    "end": 72.01366396761134,
                },
                {"text": "love", "start": 72.07368294534413, "end": 72.31375885627531},
                {
                    "text": "someone,",
                    "start": 72.33376518218624,
                    "end": 72.85392965587045,
                },
                {"text": "cause", "start": 73.2740625, "end": 73.57415738866398},
                {"text": "I", "start": 73.79422697368422, "end": 73.97428390688259},
                {"text": "might", "start": 74.2943851214575, "end": 74.51445470647774},
                {"text": "break", "start": 74.63449266194333, "end": 75.07463183198381},
            ],
            "start": 70.97333502024291,
            "end": 75.07463183198381,
        },
        {
            "words": [
                {"text": "If", "start": 75.65481528340081, "end": 75.79485956477733},
                {
                    "text": "you're",
                    "start": 75.81486589068827,
                    "end": 76.01492914979758,
                },
                {"text": "gonna", "start": 76.07494812753036, "end": 76.47507464574899},
                {"text": "die,", "start": 76.55509994939271, "end": 76.93522014170041},
                {"text": "not", "start": 77.27532768218624, "end": 77.49539726720649},
                {"text": "by", "start": 77.57542257085021, "end": 77.9555427631579},
                {
                    "text": "mistake",
                    "start": 78.29565030364373,
                    "end": 79.07589701417004,
                },
            ],
            "start": 75.65481528340081,
            "end": 79.07589701417004,
        },
        {
            "words": [
                {"text": "So", "start": 79.99618800607288, "end": 80.47633982793522},
                {"text": "where", "start": 80.57637145748988, "end": 80.81644736842105},
                {"text": "did", "start": 80.836453694332, "end": 80.99650430161944},
                {"text": "you", "start": 81.01651062753037, "end": 81.2365802125506},
                {"text": "go?", "start": 81.27659286437247, "end": 81.71673203441296},
                {"text": "I", "start": 81.85677631578947, "end": 81.9368016194332},
                {
                    "text": "should",
                    "start": 81.97681427125507,
                    "end": 82.23689650809717,
                },
                {"text": "know,", "start": 82.27690915991903, "end": 82.71704832995951},
                {"text": "but", "start": 82.81707995951417, "end": 83.01714321862349},
                {"text": "it's", "start": 83.09716852226721, "end": 83.25721912955466},
                {"text": "cold", "start": 83.33724443319838, "end": 83.7973899291498},
            ],
            "start": 79.99618800607288,
            "end": 83.7973899291498,
        },
        {
            "words": [
                {"text": "And", "start": 83.91742788461539, "end": 84.01745951417004},
                {"text": "I", "start": 84.19751644736843, "end": 84.29754807692308},
                {"text": "don't", "start": 84.317554402834, "end": 84.53762398785426},
                {"text": "wanna", "start": 84.59764296558704, "end": 84.99776948380567},
                {"text": "be", "start": 85.05778846153846, "end": 85.25785172064778},
                {
                    "text": "lonely,",
                    "start": 85.31787069838057,
                    "end": 85.93806680161944,
                },
                {"text": "so", "start": 85.99808577935222, "end": 86.19814903846154},
                {"text": "tell", "start": 86.27817434210526, "end": 86.73831983805668},
                {"text": "me", "start": 86.79833881578948, "end": 87.05842105263159},
                {"text": "to", "start": 87.07842737854251, "end": 87.11844003036437},
                {"text": "come", "start": 87.31850328947368, "end": 87.79865511133603},
                {"text": "home", "start": 88.01872469635627, "end": 88.59890814777327},
            ],
            "start": 83.91742788461539,
            "end": 88.59890814777327,
        },
        {
            "words": [
                {"text": "Even", "start": 91.15971786437247, "end": 91.51983173076923},
                {"text": "if", "start": 91.63986968623482, "end": 91.77991396761134},
                {"text": "it's", "start": 91.85993927125506, "end": 91.97997722672065},
                {"text": "just", "start": 92.03999620445344, "end": 92.34009109311741},
                {"text": "a", "start": 92.48013537449393, "end": 92.56016067813765},
                {"text": "lie", "start": 92.58016700404858, "end": 92.92027454453441},
            ],
            "start": 91.15971786437247,
            "end": 92.92027454453441,
        },
        {
            "words": [
                {"text": "I", "start": 95.36786218619247, "end": 95.46791187238495},
                {"text": "tried", "start": 95.48792180962343, "end": 95.76806093096235},
                {"text": "not", "start": 95.80808080543933, "end": 96.00818017782427},
                {"text": "to", "start": 96.04820005230125, "end": 96.2482994246862},
                {"text": "upset", "start": 96.32833917364017, "end": 96.98866710251046},
                {"text": "you,", "start": 97.02868697698746, "end": 97.36885591004184},
                {"text": "let", "start": 97.60897515690377, "end": 97.98916396443515},
                {"text": "you", "start": 98.02918383891215, "end": 98.38936270920503},
                {
                    "text": "rescue",
                    "start": 98.58946208158997,
                    "end": 99.32982975941424,
                },
                {"text": "me", "start": 99.48990925732218, "end": 99.7100185669456},
                {"text": "the", "start": 99.79005831589959, "end": 99.97014775104603},
                {"text": "day", "start": 100.03017756276151, "end": 100.31031668410043},
                {"text": "I", "start": 100.41036637029289, "end": 100.51041605648537},
                {"text": "met", "start": 100.57044586820085, "end": 101.41086323221758},
                {"text": "you", "start": 101.43087316945608, "end": 101.49090298117156},
            ],
            "start": 95.36786218619247,
            "end": 101.49090298117156,
        },
        {
            "words": [
                {"text": "I", "start": 101.81106197698746, "end": 102.01116134937239},
                {
                    "text": "just",
                    "start": 102.07119116108787,
                    "end": 102.41136009414227,
                },
                {
                    "text": "wanted",
                    "start": 102.53141971757323,
                    "end": 103.45187683054394,
                },
                {"text": "to", "start": 103.51190664225942, "end": 103.97213519874478},
                {
                    "text": "protect",
                    "start": 104.07218488493724,
                    "end": 105.41285067991633,
                },
                {"text": "you,", "start": 105.4928904288703, "end": 106.1131984832636},
                {"text": "but", "start": 107.31379471757323, "end": 107.49388415271967},
                {"text": "now", "start": 107.57392390167365, "end": 107.83405308577407},
                {"text": "I'll", "start": 107.91409283472804, "end": 108.0541623953975},
                {
                    "text": "never",
                    "start": 108.09418226987448,
                    "end": 108.51439095188286,
                },
                {"text": "get", "start": 108.57442076359834, "end": 108.9946294456067},
                {"text": "to", "start": 109.0146393828452, "end": 109.21473875523013},
            ],
            "start": 101.81106197698746,
            "end": 109.21473875523013,
        },
        {
            "words": [
                {
                    "text": "Where",
                    "start": 128.50731848802394,
                    "end": 128.7677441991018,
                },
                {"text": "did", "start": 128.78777694610778, "end": 128.96807166916167},
                {"text": "you", "start": 129.00813716317364, "end": 129.18843188622753},
                {"text": "go?", "start": 129.24853012724552, "end": 129.7693815494012},
                {"text": "I", "start": 129.86954528443113, "end": 129.9496762724551},
                {
                    "text": "should",
                    "start": 129.98974176646706,
                    "end": 130.25016747754492,
                },
                {"text": "know", "start": 130.2902329715569, "end": 130.69088791167664},
                {"text": "but", "start": 130.7710188997006, "end": 131.01141186377245},
                {"text": "it's", "start": 131.0715101047904, "end": 131.2317720808383},
                {"text": "cold", "start": 131.31190306886228, "end": 131.77265625},
                {"text": "and", "start": 131.87281998502993, "end": 132.01304921407186},
                {"text": "I", "start": 132.15327844311378, "end": 132.2534421781437},
                {
                    "text": "don't",
                    "start": 132.2935076721557,
                    "end": 132.53390063622754,
                },
                {
                    "text": "wanna",
                    "start": 132.81435909431138,
                    "end": 132.9145228293413,
                },
                {"text": "be", "start": 133.03471931137724, "end": 133.23504678143712},
                {
                    "text": "lonely",
                    "start": 133.29514502245507,
                    "end": 133.99629116766465,
                },
            ],
            "start": 128.50731848802394,
            "end": 133.99629116766465,
        },
        {
            "words": [
                {
                    "text": "What's",
                    "start": 134.05638940868263,
                    "end": 134.29678237275448,
                },
                {
                    "text": "hoping",
                    "start": 134.33684786676645,
                    "end": 135.01796126497004,
                },
                {
                    "text": "you'd",
                    "start": 135.03799401197605,
                    "end": 135.19825598802396,
                },
                {
                    "text": "come",
                    "start": 135.33848521706585,
                    "end": 135.73914015718563,
                },
                {
                    "text": "home?",
                    "start": 136.01959861526944,
                    "end": 136.48035179640718,
                },
            ],
            "start": 134.05638940868263,
            "end": 136.48035179640718,
        },
        {
            "words": [
                {"text": "I", "start": 139.20480538922155, "end": 139.2649036302395},
                {
                    "text": "don't",
                    "start": 139.30496912425147,
                    "end": 139.52532934131736,
                },
                {"text": "care", "start": 139.6054603293413, "end": 140.12631175149698},
                {"text": "if", "start": 140.22647548652694, "end": 140.32663922155686},
                {
                    "text": "it's",
                    "start": 140.52696669161676,
                    "end": 140.72729416167664,
                },
                {"text": "a", "start": 140.9276216317365, "end": 141.02778536676647},
                {"text": "lie", "start": 141.1079163547904, "end": 141.58870228293412},
            ],
            "start": 139.20480538922155,
            "end": 141.58870228293412,
        },
    ]
}
spotify_lyrics_data = {
    "lines": [
        {
            "words": [
                {"text": "Told", "start": None, "end": None},
                {"text": "you", "start": None, "end": None},
                {"text": "not", "start": None, "end": None},
                {"text": "to", "start": None, "end": None},
                {"text": "worry", "start": None, "end": None},
            ],
            "start": 6.9,
            "end": None,
        },
        {
            "words": [
                {"text": "But", "start": None, "end": None},
                {"text": "maybe", "start": None, "end": None},
                {"text": "that's", "start": None, "end": None},
                {"text": "a", "start": None, "end": None},
                {"text": "lie", "start": None, "end": None},
            ],
            "start": 10.59,
            "end": None,
        },
        {
            "words": [
                {"text": "Honey,", "start": None, "end": None},
                {"text": "what's", "start": None, "end": None},
                {"text": "your", "start": None, "end": None},
                {"text": "hurry?", "start": None, "end": None},
            ],
            "start": 14.86,
            "end": None,
        },
        {
            "words": [
                {"text": "Won't", "start": None, "end": None},
                {"text": "you", "start": None, "end": None},
                {"text": "stay", "start": None, "end": None},
                {"text": "inside?", "start": None, "end": None},
            ],
            "start": 18.46,
            "end": None,
        },
        {
            "words": [
                {"text": "Remember", "start": None, "end": None},
                {"text": "not", "start": None, "end": None},
                {"text": "to", "start": None, "end": None},
                {"text": "get", "start": None, "end": None},
                {"text": "too", "start": None, "end": None},
                {"text": "close", "start": None, "end": None},
                {"text": "to", "start": None, "end": None},
                {"text": "stars", "start": None, "end": None},
            ],
            "start": 22.84,
            "end": None,
        },
        {
            "words": [
                {"text": "They're", "start": None, "end": None},
                {"text": "never", "start": None, "end": None},
                {"text": "gonna", "start": None, "end": None},
                {"text": "give", "start": None, "end": None},
                {"text": "you", "start": None, "end": None},
                {"text": "love", "start": None, "end": None},
                {"text": "like", "start": None, "end": None},
                {"text": "ours", "start": None, "end": None},
            ],
            "start": 26.71,
            "end": None,
        },
        {
            "words": [
                {"text": "Where", "start": None, "end": None},
                {"text": "did", "start": None, "end": None},
                {"text": "you", "start": None, "end": None},
                {"text": "go?", "start": None, "end": None},
            ],
            "start": 31.77,
            "end": None,
        },
        {
            "words": [
                {"text": "I", "start": None, "end": None},
                {"text": "should", "start": None, "end": None},
                {"text": "know,", "start": None, "end": None},
                {"text": "but", "start": None, "end": None},
                {"text": "it's", "start": None, "end": None},
                {"text": "cold", "start": None, "end": None},
            ],
            "start": 33.11,
            "end": None,
        },
        {
            "words": [
                {"text": "And", "start": None, "end": None},
                {"text": "I", "start": None, "end": None},
                {"text": "don't", "start": None, "end": None},
                {"text": "wanna", "start": None, "end": None},
                {"text": "be", "start": None, "end": None},
                {"text": "lonely", "start": None, "end": None},
            ],
            "start": 35.33,
            "end": None,
        },
        {
            "words": [
                {"text": "So", "start": None, "end": None},
                {"text": "show", "start": None, "end": None},
                {"text": "me", "start": None, "end": None},
                {"text": "the", "start": None, "end": None},
                {"text": "way", "start": None, "end": None},
                {"text": "home", "start": None, "end": None},
            ],
            "start": 37.44,
            "end": None,
        },
        {
            "words": [
                {"text": "I", "start": None, "end": None},
                {"text": "can't", "start": None, "end": None},
                {"text": "lose", "start": None, "end": None},
                {"text": "another", "start": None, "end": None},
                {"text": "life", "start": None, "end": None},
            ],
            "start": 42.24,
            "end": None,
        },
        {
            "words": [
                {"text": "Hurry,", "start": None, "end": None},
                {"text": "I'm", "start": None, "end": None},
                {"text": "worried", "start": None, "end": None},
            ],
            "start": 48.01,
            "end": None,
        },
        {
            "words": [
                {"text": "The", "start": None, "end": None},
                {"text": "world's", "start": None, "end": None},
                {"text": "a", "start": None, "end": None},
                {"text": "little", "start": None, "end": None},
                {"text": "blurry", "start": None, "end": None},
            ],
            "start": 54.65,
            "end": None,
        },
        {
            "words": [
                {"text": "Or", "start": None, "end": None},
                {"text": "maybe", "start": None, "end": None},
                {"text": "it's", "start": None, "end": None},
                {"text": "my", "start": None, "end": None},
                {"text": "eyes", "start": None, "end": None},
            ],
            "start": 58.78,
            "end": None,
        },
        {
            "words": [
                {"text": "The", "start": None, "end": None},
                {"text": "friends", "start": None, "end": None},
                {"text": "I've", "start": None, "end": None},
                {"text": "had", "start": None, "end": None},
                {"text": "to", "start": None, "end": None},
                {"text": "bury", "start": None, "end": None},
            ],
            "start": 62.83,
            "end": None,
        },
        {
            "words": [
                {"text": "They", "start": None, "end": None},
                {"text": "keep", "start": None, "end": None},
                {"text": "me", "start": None, "end": None},
                {"text": "up", "start": None, "end": None},
                {"text": "at", "start": None, "end": None},
                {"text": "night", "start": None, "end": None},
            ],
            "start": 66.57,
            "end": None,
        },
        {
            "words": [
                {"text": "Said", "start": None, "end": None},
                {"text": "I", "start": None, "end": None},
                {"text": "couldn't", "start": None, "end": None},
                {"text": "love", "start": None, "end": None},
                {"text": "someone", "start": None, "end": None},
            ],
            "start": 70.55,
            "end": None,
        },
        {
            "words": [
                {"text": "'Cause", "start": None, "end": None},
                {"text": "I", "start": None, "end": None},
                {"text": "might", "start": None, "end": None},
                {"text": "break", "start": None, "end": None},
            ],
            "start": 72.8,
            "end": None,
        },
        {
            "words": [
                {"text": "If", "start": None, "end": None},
                {"text": "you're", "start": None, "end": None},
                {"text": "gonna", "start": None, "end": None},
                {"text": "die,", "start": None, "end": None},
                {"text": "not", "start": None, "end": None},
                {"text": "by", "start": None, "end": None},
                {"text": "mistake", "start": None, "end": None},
            ],
            "start": 74.82,
            "end": None,
        },
        {
            "words": [
                {"text": "So,", "start": None, "end": None},
                {"text": "where", "start": None, "end": None},
                {"text": "did", "start": None, "end": None},
                {"text": "you", "start": None, "end": None},
                {"text": "go?", "start": None, "end": None},
            ],
            "start": 79.26,
            "end": None,
        },
        {
            "words": [
                {"text": "I", "start": None, "end": None},
                {"text": "should", "start": None, "end": None},
                {"text": "know,", "start": None, "end": None},
                {"text": "but", "start": None, "end": None},
                {"text": "it's", "start": None, "end": None},
                {"text": "cold", "start": None, "end": None},
            ],
            "start": 80.98,
            "end": None,
        },
        {
            "words": [
                {"text": "And", "start": None, "end": None},
                {"text": "I", "start": None, "end": None},
                {"text": "don't", "start": None, "end": None},
                {"text": "wanna", "start": None, "end": None},
                {"text": "be", "start": None, "end": None},
                {"text": "lonely", "start": None, "end": None},
            ],
            "start": 83.25,
            "end": None,
        },
        {
            "words": [
                {"text": "So", "start": None, "end": None},
                {"text": "tell", "start": None, "end": None},
                {"text": "me", "start": None, "end": None},
                {"text": "you'll", "start": None, "end": None},
                {"text": "come", "start": None, "end": None},
                {"text": "home", "start": None, "end": None},
            ],
            "start": 85.36,
            "end": None,
        },
        {
            "words": [
                {"text": "Even", "start": None, "end": None},
                {"text": "if", "start": None, "end": None},
                {"text": "it's", "start": None, "end": None},
                {"text": "just", "start": None, "end": None},
                {"text": "a", "start": None, "end": None},
                {"text": "lie", "start": None, "end": None},
            ],
            "start": 90.3,
            "end": None,
        },
        {
            "words": [
                {"text": "I", "start": None, "end": None},
                {"text": "tried", "start": None, "end": None},
                {"text": "not", "start": None, "end": None},
                {"text": "to", "start": None, "end": None},
                {"text": "upset", "start": None, "end": None},
                {"text": "you", "start": None, "end": None},
            ],
            "start": 94.77,
            "end": None,
        },
        {
            "words": [
                {"text": "Let", "start": None, "end": None},
                {"text": "you,", "start": None, "end": None},
                {"text": "rescue,", "start": None, "end": None},
                {"text": "me", "start": None, "end": None},
                {"text": "the", "start": None, "end": None},
                {"text": "day", "start": None, "end": None},
                {"text": "I", "start": None, "end": None},
                {"text": "met", "start": None, "end": None},
                {"text": "you", "start": None, "end": None},
            ],
            "start": 96.93,
            "end": None,
        },
        {
            "words": [
                {"text": "I", "start": None, "end": None},
                {"text": "just", "start": None, "end": None},
                {"text": "wanted", "start": None, "end": None},
                {"text": "to", "start": None, "end": None},
                {"text": "protect", "start": None, "end": None},
                {"text": "you", "start": None, "end": None},
            ],
            "start": 101.1,
            "end": None,
        },
        {
            "words": [
                {"text": "But", "start": None, "end": None},
                {"text": "now", "start": None, "end": None},
                {"text": "I'll", "start": None, "end": None},
                {"text": "never", "start": None, "end": None},
                {"text": "get", "start": None, "end": None},
                {"text": "to", "start": None, "end": None},
            ],
            "start": 106.67,
            "end": None,
        },
        {
            "words": [
                {"text": "Hurry,", "start": None, "end": None},
                {"text": "I'm", "start": None, "end": None},
                {"text": "worried", "start": None, "end": None},
            ],
            "start": 112.25,
            "end": None,
        },
        {
            "words": [{"text": "\u266a", "start": None, "end": None}],
            "start": 120.45,
            "end": None,
        },
        {
            "words": [
                {"text": "Where", "start": None, "end": None},
                {"text": "did", "start": None, "end": None},
                {"text": "you", "start": None, "end": None},
                {"text": "go?", "start": None, "end": None},
            ],
            "start": 128.02,
            "end": None,
        },
        {
            "words": [
                {"text": "I", "start": None, "end": None},
                {"text": "should", "start": None, "end": None},
                {"text": "know,", "start": None, "end": None},
                {"text": "but", "start": None, "end": None},
                {"text": "it's", "start": None, "end": None},
                {"text": "cold", "start": None, "end": None},
            ],
            "start": 129.2,
            "end": None,
        },
        {
            "words": [
                {"text": "And", "start": None, "end": None},
                {"text": "I", "start": None, "end": None},
                {"text": "don't", "start": None, "end": None},
                {"text": "wanna", "start": None, "end": None},
                {"text": "be", "start": None, "end": None},
                {"text": "lonely", "start": None, "end": None},
            ],
            "start": 131.16,
            "end": None,
        },
        {
            "words": [
                {"text": "Was", "start": None, "end": None},
                {"text": "hoping", "start": None, "end": None},
                {"text": "you'd", "start": None, "end": None},
                {"text": "come", "start": None, "end": None},
                {"text": "home", "start": None, "end": None},
            ],
            "start": 133.21,
            "end": None,
        },
        {
            "words": [
                {"text": "I", "start": None, "end": None},
                {"text": "don't", "start": None, "end": None},
                {"text": "care", "start": None, "end": None},
                {"text": "if", "start": None, "end": None},
                {"text": "it's", "start": None, "end": None},
                {"text": "a", "start": None, "end": None},
                {"text": "lie", "start": None, "end": None},
            ],
            "start": 138.57,
            "end": None,
        },
        {"words": [], "start": 141.09, "end": None},
    ]
}

merged_lyrics_data = {
    "lines": [
        {
            "words": [
                {"text": "Bum", "start": 1.73, "end": 2.09},
                {"text": "bum", "start": 2.09, "end": 2.46},
                {"text": "be-dum,", "start": 2.46, "end": 2.82},
                {"text": "bum", "start": 2.82, "end": 3.18},
                {"text": "bum", "start": 3.18, "end": 3.54},
                {"text": "be-dum", "start": 3.54, "end": 3.91},
                {"text": "bum", "start": 3.91, "end": 4.27},
                {"text": "(what's", "start": 4.27, "end": 4.63},
                {"text": "wrong", "start": 4.63, "end": 4.99},
                {"text": "with", "start": 4.99, "end": 5.36},
                {"text": "me?)", "start": 5.36, "end": 5.72},
            ],
            "start": 1.73,
            "end": 5.72,
        },
        {
            "words": [
                {"text": "Bum", "start": 5.72, "end": 6.01},
                {"text": "bum", "start": 6.01, "end": 6.3},
                {"text": "be-dum,", "start": 6.3, "end": 6.59},
                {"text": "bum", "start": 6.59, "end": 6.89},
                {"text": "bum", "start": 6.89, "end": 7.18},
                {"text": "be-dum", "start": 7.18, "end": 7.47},
                {"text": "bum", "start": 7.47, "end": 7.76},
                {"text": "(why", "start": 7.76, "end": 8.05},
                {"text": "do", "start": 8.05, "end": 8.34},
                {"text": "I", "start": 8.34, "end": 8.64},
                {"text": "feel", "start": 8.64, "end": 8.93},
                {"text": "like", "start": 8.93, "end": 9.22},
                {"text": "this?)", "start": 9.22, "end": 9.51},
            ],
            "start": 5.72,
            "end": 9.51,
        },
        {
            "words": [
                {"text": "Bum", "start": 9.51, "end": 9.9},
                {"text": "bum", "start": 9.9, "end": 10.29},
                {"text": "be-dum,", "start": 10.29, "end": 10.68},
                {"text": "bum", "start": 10.68, "end": 11.07},
                {"text": "bum", "start": 11.07, "end": 11.46},
                {"text": "be-dum", "start": 11.46, "end": 11.84},
                {"text": "bum", "start": 11.84, "end": 12.23},
                {"text": "(I'm", "start": 12.23, "end": 12.62},
                {"text": "going", "start": 12.62, "end": 13.01},
                {"text": "crazy", "start": 13.01, "end": 13.4},
                {"text": "now)", "start": 13.4, "end": 13.79},
            ],
            "start": 9.51,
            "end": 13.79,
        },
        {
            "words": [
                {"text": "Bum", "start": 13.79, "end": 14.32},
                {"text": "bum", "start": 14.32, "end": 14.86},
                {"text": "be-dum,", "start": 14.86, "end": 15.39},
                {"text": "bum", "start": 15.39, "end": 15.92},
                {"text": "bum", "start": 15.92, "end": 16.45},
                {"text": "be-dum", "start": 16.45, "end": 16.99},
                {"text": "bum", "start": 16.99, "end": 17.52},
            ],
            "start": 13.79,
            "end": 17.52,
        },
        {
            "words": [
                {"text": "No", "start": 17.52, "end": 17.74},
                {"text": "more", "start": 17.78, "end": 17.98},
                {"text": "gas,", "start": 18.02, "end": 18.5},
                {"text": "in", "start": 18.62, "end": 18.72},
                {"text": "the", "start": 18.76, "end": 18.92},
                {"text": "red", "start": 18.96, "end": 19.54},
                {"text": "(can't", "start": 19.58, "end": 19.74},
                {"text": "even", "start": 19.84, "end": 20.12},
                {"text": "get", "start": 20.16, "end": 20.52},
                {"text": "it", "start": 20.52, "end": 20.58},
                {"text": "started)", "start": 20.58, "end": 21.12},
            ],
            "start": 17.52,
            "end": 21.12,
        },
        {
            "words": [
                {"text": "Nothing", "start": 21.43, "end": 21.83},
                {"text": "heard,", "start": 21.91, "end": 22.33},
                {"text": "nothing", "start": 22.39, "end": 22.75},
                {"text": "said", "start": 22.85, "end": 23.39},
                {"text": "(can't", "start": 23.41, "end": 23.63},
                {"text": "even", "start": 23.71, "end": 23.95},
                {"text": "speak", "start": 23.97, "end": 24.31},
                {"text": "about", "start": 24.37, "end": 24.87},
                {"text": "it)", "start": 24.91, "end": 24.97},
            ],
            "start": 21.43,
            "end": 24.97,
        },
        {
            "words": [
                {"text": "All", "start": 25.27, "end": 25.58},
                {"text": "my", "start": 25.58, "end": 25.88},
                {"text": "life", "start": 25.88, "end": 26.19},
                {"text": "on", "start": 26.19, "end": 26.5},
                {"text": "my", "start": 26.5, "end": 26.8},
                {"text": "head", "start": 26.8, "end": 27.11},
                {"text": "(don't", "start": 27.11, "end": 27.31},
                {"text": "want", "start": 27.31, "end": 27.56},
                {"text": "to", "start": 27.56, "end": 27.81},
                {"text": "think", "start": 27.81, "end": 28.09},
                {"text": "about", "start": 28.15, "end": 28.63},
                {"text": "it)", "start": 28.67, "end": 28.73},
            ],
            "start": 25.27,
            "end": 28.73,
        },
        {
            "words": [
                {"text": "Feels", "start": 29.15, "end": 29.45},
                {"text": "like", "start": 29.47, "end": 29.65},
                {"text": "I'm", "start": 29.73, "end": 29.85},
                {"text": "going", "start": 29.91, "end": 30.19},
                {"text": "insane,", "start": 30.27, "end": 31.07},
                {"text": "yeah", "start": 31.17, "end": 32.65},
            ],
            "start": 29.15,
            "end": 32.65,
        },
        {
            "words": [
                {"text": "It's", "start": 32.92, "end": 33.06},
                {"text": "a", "start": 33.06, "end": 33.38},
                {"text": "thief", "start": 33.38, "end": 33.86},
                {"text": "in", "start": 33.96, "end": 34.06},
                {"text": "the", "start": 34.08, "end": 34.26},
                {"text": "night", "start": 34.36, "end": 34.76},
                {"text": "to", "start": 34.8, "end": 34.92},
                {"text": "come", "start": 35.02, "end": 35.3},
                {"text": "and", "start": 35.34, "end": 35.46},
                {"text": "grab", "start": 35.54, "end": 36.04},
                {"text": "you", "start": 36.08, "end": 36.42},
                {"text": "(ah-ah)", "start": 36.42, "end": 37.02},
            ],
            "start": 32.92,
            "end": 37.02,
        },
        {
            "words": [
                {"text": "It", "start": 37.02, "end": 37.14},
                {"text": "can", "start": 37.26, "end": 37.42},
                {"text": "creep", "start": 37.48, "end": 37.94},
                {"text": "up", "start": 38.08, "end": 38.18},
                {"text": "inside", "start": 38.26, "end": 38.86},
                {"text": "you", "start": 38.92, "end": 39.18},
                {"text": "and", "start": 39.26, "end": 39.36},
                {"text": "consume", "start": 39.38, "end": 40.08},
                {"text": "you", "start": 40.12, "end": 40.54},
                {"text": "(ah-ah)", "start": 40.54, "end": 40.58},
            ],
            "start": 37.02,
            "end": 40.58,
        },
        {
            "words": [
                {"text": "A", "start": 40.58, "end": 40.66},
                {"text": "disease", "start": 40.74, "end": 41.44},
                {"text": "of", "start": 41.58, "end": 41.7},
                {"text": "the", "start": 41.7, "end": 41.94},
                {"text": "mind,", "start": 41.94, "end": 42.38},
                {"text": "it", "start": 42.46, "end": 42.52},
                {"text": "can", "start": 42.52, "end": 42.88},
                {"text": "control", "start": 42.88, "end": 43.62},
                {"text": "you", "start": 43.66, "end": 44.0},
                {"text": "(ah-ah)", "start": 44.0, "end": 44.39},
            ],
            "start": 40.58,
            "end": 44.39,
        },
        {
            "words": [
                {"text": "It's", "start": 44.39, "end": 60.31},
                {"text": "too", "start": 60.31, "end": 76.23},
                {"text": "close", "start": 76.23, "end": 92.16},
                {"text": "for", "start": 92.16, "end": 108.08},
                {"text": "comfort,", "start": 108.08, "end": 124.0},
                {"text": "oh", "start": 124.0, "end": 124.32},
            ],
            "start": 44.39,
            "end": 124.32,
        },
        {
            "words": [
                {"text": "Put", "start": 47.3, "end": 47.71},
                {"text": "on", "start": 47.71, "end": 48.11},
                {"text": "your", "start": 48.11, "end": 48.52},
                {"text": "brake", "start": 48.52, "end": 48.92},
                {"text": "lights", "start": 48.92, "end": 49.33},
            ],
            "start": 47.3,
            "end": 49.33,
        },
        {
            "words": [
                {"text": "You're", "start": 49.33, "end": 126.3},
                {"text": "in", "start": 126.3, "end": 126.38},
                {"text": "the", "start": 126.44, "end": 126.54},
                {"text": "city", "start": 126.62, "end": 127.19},
                {"text": "of", "start": 127.19, "end": 89.32},
                {"text": "wonder", "start": 89.32, "end": 51.46},
            ],
            "start": 49.33,
            "end": 51.46,
        },
        {
            "words": [
                {"text": "Ain't", "start": 51.46, "end": 51.88},
                {"text": "gon'", "start": 51.88, "end": 52.31},
                {"text": "play", "start": 52.31, "end": 52.73},
                {"text": "nice", "start": 52.73, "end": 53.16},
            ],
            "start": 51.46,
            "end": 53.16,
        },
        {
            "words": [
                {"text": "Watch", "start": 53.16, "end": 91.6},
                {"text": "out,", "start": 91.6, "end": 130.03},
                {"text": "you", "start": 130.03, "end": 130.53},
                {"text": "might", "start": 130.57, "end": 131.25},
                {"text": "just", "start": 131.29, "end": 131.43},
                {"text": "go", "start": 131.43, "end": 93.41},
                {"text": "under", "start": 93.41, "end": 55.39},
            ],
            "start": 53.16,
            "end": 55.39,
        },
        {
            "words": [
                {"text": "Better", "start": 55.39, "end": 55.75},
                {"text": "think", "start": 55.75, "end": 56.29},
                {"text": "twice", "start": 56.29, "end": 56.73},
            ],
            "start": 55.39,
            "end": 56.73,
        },
        {
            "words": [
                {"text": "Your", "start": 57.02, "end": 72.59},
                {"text": "train", "start": 72.59, "end": 88.16},
                {"text": "of", "start": 88.16, "end": 103.73},
                {"text": "thought", "start": 103.73, "end": 119.3},
                {"text": "will", "start": 119.3, "end": 134.87},
                {"text": "be", "start": 134.87, "end": 135.05},
                {"text": "altered", "start": 135.27, "end": 135.83},
            ],
            "start": 57.02,
            "end": 135.83,
        },
        {
            "words": [
                {"text": "So", "start": 59.28, "end": 59.52},
                {"text": "if", "start": 59.64, "end": 59.7},
                {"text": "you", "start": 59.74, "end": 60.02},
                {"text": "must", "start": 60.04, "end": 60.18},
                {"text": "falter,", "start": 60.18, "end": 61.0},
                {"text": "be", "start": 61.0, "end": 61.22},
                {"text": "wise", "start": 61.22, "end": 62.28},
            ],
            "start": 59.28,
            "end": 62.28,
        },
        {
            "words": [
                {"text": "Your", "start": 62.28, "end": 62.92},
                {"text": "mind's", "start": 62.92, "end": 63.57},
                {"text": "in", "start": 63.57, "end": 64.22},
                {"text": "disturbia", "start": 64.22, "end": 64.86},
            ],
            "start": 62.28,
            "end": 64.86,
        },
        {
            "words": [
                {"text": "It's", "start": 64.86, "end": 141.65},
                {"text": "like", "start": 141.65, "end": 141.77},
                {"text": "the", "start": 141.81, "end": 142.01},
                {"text": "darkness", "start": 142.05, "end": 142.7},
                {"text": "is", "start": 142.86, "end": 143.06},
                {"text": "the", "start": 143.1, "end": 143.18},
                {"text": "light", "start": 143.26, "end": 143.96},
            ],
            "start": 64.86,
            "end": 143.96,
        },
        {
            "words": [
                {"text": "Disturbia,", "start": 67.13, "end": 81.77},
                {"text": "am", "start": 81.77, "end": 96.4},
                {"text": "I", "start": 96.4, "end": 111.04},
                {"text": "scaring", "start": 111.04, "end": 125.67},
                {"text": "you", "start": 125.67, "end": 140.31},
                {"text": "tonight?", "start": 140.31, "end": 154.94},
                {"text": "(Your", "start": 154.94, "end": 169.58},
                {"text": "mind", "start": 169.58, "end": 170.74},
                {"text": "is", "start": 170.74, "end": 120.88},
                {"text": "in)", "start": 120.88, "end": 71.03},
            ],
            "start": 67.13,
            "end": 71.03,
        },
        {
            "words": [
                {"text": "Disturbia,", "start": 71.03, "end": 71.58},
                {"text": "ain't", "start": 71.58, "end": 72.12},
                {"text": "used", "start": 72.12, "end": 72.67},
                {"text": "to", "start": 72.67, "end": 73.21},
                {"text": "what", "start": 73.21, "end": 73.76},
                {"text": "you", "start": 73.76, "end": 74.3},
                {"text": "like", "start": 74.3, "end": 74.85},
            ],
            "start": 71.03,
            "end": 74.85,
        },
        {
            "words": [
                {"text": "Disturbia,", "start": 74.85, "end": 76.81},
                {"text": "disturbia", "start": 76.81, "end": 78.77},
            ],
            "start": 74.85,
            "end": 78.77,
        },
        {
            "words": [
                {"text": "Bum", "start": 78.77, "end": 79.32},
                {"text": "bum", "start": 79.32, "end": 79.88},
                {"text": "be-dum,", "start": 79.88, "end": 80.43},
                {"text": "bum", "start": 80.43, "end": 80.99},
                {"text": "bum", "start": 80.99, "end": 81.54},
                {"text": "be-dum", "start": 81.54, "end": 82.1},
                {"text": "bum", "start": 82.1, "end": 82.65},
            ],
            "start": 78.77,
            "end": 82.65,
        },
        {
            "words": [
                {"text": "Bum", "start": 82.65, "end": 83.2},
                {"text": "bum", "start": 83.2, "end": 83.75},
                {"text": "be-dum,", "start": 83.75, "end": 84.3},
                {"text": "bum", "start": 84.3, "end": 84.84},
                {"text": "bum", "start": 84.84, "end": 85.39},
                {"text": "be-dum", "start": 85.39, "end": 85.94},
                {"text": "bum", "start": 85.94, "end": 86.49},
            ],
            "start": 82.65,
            "end": 86.49,
        },
        {
            "words": [
                {"text": "Bum", "start": 86.49, "end": 87.03},
                {"text": "bum", "start": 87.03, "end": 87.57},
                {"text": "be-dum,", "start": 87.57, "end": 88.11},
                {"text": "bum", "start": 88.11, "end": 88.66},
                {"text": "bum", "start": 88.66, "end": 89.2},
                {"text": "be-dum", "start": 89.2, "end": 89.74},
                {"text": "bum", "start": 89.74, "end": 90.28},
            ],
            "start": 86.49,
            "end": 90.28,
        },
        {
            "words": [
                {"text": "Bum", "start": 90.28, "end": 90.84},
                {"text": "bum", "start": 90.84, "end": 91.41},
                {"text": "be-dum,", "start": 91.41, "end": 91.97},
                {"text": "bum", "start": 91.97, "end": 92.54},
                {"text": "bum", "start": 92.54, "end": 93.1},
                {"text": "be-dum", "start": 93.1, "end": 93.67},
                {"text": "bum", "start": 93.67, "end": 94.23},
            ],
            "start": 90.28,
            "end": 94.23,
        },
        {
            "words": [
                {"text": "Faded", "start": 94.23, "end": 94.6},
                {"text": "pictures", "start": 94.6, "end": 94.96},
                {"text": "on", "start": 94.96, "end": 95.33},
                {"text": "the", "start": 95.33, "end": 95.7},
                {"text": "wall", "start": 95.7, "end": 96.06},
                {"text": "(it's", "start": 96.06, "end": 96.43},
                {"text": "like", "start": 96.43, "end": 96.79},
                {"text": "they", "start": 96.79, "end": 97.16},
                {"text": "talkin'", "start": 97.16, "end": 97.53},
                {"text": "to", "start": 97.53, "end": 97.89},
                {"text": "me)", "start": 97.89, "end": 98.26},
            ],
            "start": 94.23,
            "end": 98.26,
        },
        {
            "words": [
                {"text": "Disconnected,", "start": 98.26, "end": 98.69},
                {"text": "no", "start": 98.69, "end": 99.11},
                {"text": "one", "start": 99.11, "end": 99.54},
                {"text": "calls", "start": 99.54, "end": 99.97},
                {"text": "(the", "start": 99.97, "end": 100.39},
                {"text": "phone", "start": 100.39, "end": 100.82},
                {"text": "don't", "start": 100.82, "end": 101.25},
                {"text": "even", "start": 101.25, "end": 101.67},
                {"text": "ring)", "start": 101.67, "end": 102.1},
            ],
            "start": 98.26,
            "end": 102.1,
        },
        {
            "words": [
                {"text": "I", "start": 102.1, "end": 102.5},
                {"text": "gotta", "start": 102.5, "end": 102.89},
                {"text": "get", "start": 102.89, "end": 103.29},
                {"text": "out", "start": 103.29, "end": 103.69},
                {"text": "or", "start": 103.69, "end": 104.08},
                {"text": "figure", "start": 104.08, "end": 104.48},
                {"text": "this", "start": 104.48, "end": 104.88},
                {"text": "shit", "start": 104.88, "end": 105.27},
                {"text": "out", "start": 105.27, "end": 105.67},
            ],
            "start": 102.1,
            "end": 105.67,
        },
        {
            "words": [
                {"text": "It's", "start": 105.67, "end": 106.36},
                {"text": "too", "start": 106.36, "end": 107.04},
                {"text": "close", "start": 107.04, "end": 107.72},
                {"text": "for", "start": 107.72, "end": 108.41},
                {"text": "comfort,", "start": 108.41, "end": 109.09},
                {"text": "oh", "start": 109.09, "end": 109.78},
            ],
            "start": 105.67,
            "end": 109.78,
        },
        {
            "words": [
                {"text": "It's", "start": 109.78, "end": 110.12},
                {"text": "a", "start": 110.12, "end": 110.45},
                {"text": "thief", "start": 110.45, "end": 110.79},
                {"text": "in", "start": 110.79, "end": 111.12},
                {"text": "the", "start": 111.12, "end": 111.46},
                {"text": "night", "start": 111.46, "end": 111.8},
                {"text": "to", "start": 111.8, "end": 112.13},
                {"text": "come", "start": 112.13, "end": 112.47},
                {"text": "and", "start": 112.47, "end": 112.8},
                {"text": "grab", "start": 112.8, "end": 113.14},
                {"text": "you", "start": 113.14, "end": 113.47},
                {"text": "(ooh)", "start": 113.47, "end": 113.81},
            ],
            "start": 109.78,
            "end": 113.81,
        },
        {
            "words": [
                {"text": "It", "start": 113.81, "end": 114.18},
                {"text": "can", "start": 114.18, "end": 114.54},
                {"text": "creep", "start": 114.54, "end": 114.91},
                {"text": "up", "start": 114.91, "end": 115.27},
                {"text": "inside", "start": 115.27, "end": 115.64},
                {"text": "you", "start": 115.64, "end": 116.01},
                {"text": "and", "start": 116.01, "end": 116.37},
                {"text": "consume", "start": 116.37, "end": 116.74},
                {"text": "you", "start": 116.74, "end": 117.1},
                {"text": "(ooh)", "start": 117.1, "end": 117.47},
            ],
            "start": 113.81,
            "end": 117.47,
        },
        {
            "words": [
                {"text": "A", "start": 117.47, "end": 117.84},
                {"text": "disease", "start": 117.84, "end": 118.22},
                {"text": "of", "start": 118.22, "end": 118.59},
                {"text": "the", "start": 118.59, "end": 118.96},
                {"text": "mind,", "start": 118.96, "end": 119.34},
                {"text": "it", "start": 119.34, "end": 119.71},
                {"text": "can", "start": 119.71, "end": 120.08},
                {"text": "control", "start": 120.08, "end": 120.45},
                {"text": "you", "start": 120.45, "end": 120.83},
                {"text": "(ooh)", "start": 120.83, "end": 121.2},
            ],
            "start": 117.47,
            "end": 121.2,
        },
        {
            "words": [
                {"text": "I", "start": 121.2, "end": 121.71},
                {"text": "feel", "start": 121.71, "end": 122.22},
                {"text": "like", "start": 122.22, "end": 122.72},
                {"text": "a", "start": 122.72, "end": 123.23},
                {"text": "monster,", "start": 123.23, "end": 123.74},
                {"text": "oh", "start": 123.74, "end": 124.25},
            ],
            "start": 121.2,
            "end": 124.25,
        },
        {
            "words": [
                {"text": "Put", "start": 124.25, "end": 124.63},
                {"text": "on", "start": 124.63, "end": 125.01},
                {"text": "your", "start": 125.01, "end": 125.38},
                {"text": "brake", "start": 125.38, "end": 125.76},
                {"text": "lights", "start": 125.76, "end": 126.14},
            ],
            "start": 124.25,
            "end": 126.14,
        },
        {
            "words": [
                {"text": "You're", "start": 126.14, "end": 126.4},
                {"text": "in", "start": 126.4, "end": 126.67},
                {"text": "the", "start": 126.67, "end": 126.93},
                {"text": "city", "start": 126.93, "end": 127.19},
                {"text": "of", "start": 127.19, "end": 127.46},
                {"text": "wonder", "start": 127.46, "end": 127.72},
                {"text": "(city", "start": 127.72, "end": 127.99},
                {"text": "lights)", "start": 127.99, "end": 128.25},
            ],
            "start": 126.14,
            "end": 128.25,
        },
        {
            "words": [
                {"text": "Ain't", "start": 128.25, "end": 128.7},
                {"text": "gon'", "start": 128.7, "end": 129.16},
                {"text": "play", "start": 129.16, "end": 129.62},
                {"text": "nice", "start": 129.62, "end": 130.07},
            ],
            "start": 128.25,
            "end": 130.07,
        },
        {
            "words": [
                {"text": "Watch", "start": 130.07, "end": 130.37},
                {"text": "out,", "start": 130.37, "end": 130.67},
                {"text": "you", "start": 130.67, "end": 130.97},
                {"text": "might", "start": 130.97, "end": 131.27},
                {"text": "just", "start": 131.27, "end": 131.57},
                {"text": "go", "start": 131.57, "end": 131.87},
                {"text": "under", "start": 131.87, "end": 132.17},
            ],
            "start": 130.07,
            "end": 132.17,
        },
        {
            "words": [
                {"text": "Better", "start": 132.17, "end": 132.53},
                {"text": "think", "start": 132.53, "end": 132.88},
                {"text": "twice", "start": 132.88, "end": 133.24},
                {"text": "(think", "start": 133.24, "end": 133.59},
                {"text": "twice)", "start": 133.59, "end": 133.95},
            ],
            "start": 132.17,
            "end": 133.95,
        },
        {
            "words": [
                {"text": "Your", "start": 133.95, "end": 134.25},
                {"text": "train", "start": 134.25, "end": 134.56},
                {"text": "of", "start": 134.56, "end": 134.86},
                {"text": "thought", "start": 134.86, "end": 135.16},
                {"text": "will", "start": 135.16, "end": 135.46},
                {"text": "be", "start": 135.46, "end": 135.77},
                {"text": "altered", "start": 135.77, "end": 136.07},
            ],
            "start": 133.95,
            "end": 136.07,
        },
        {
            "words": [
                {"text": "So", "start": 136.07, "end": 136.41},
                {"text": "if", "start": 136.41, "end": 136.76},
                {"text": "you", "start": 136.76, "end": 137.1},
                {"text": "must", "start": 137.1, "end": 137.45},
                {"text": "falter,", "start": 137.45, "end": 137.79},
                {"text": "be", "start": 137.79, "end": 138.14},
                {"text": "wise", "start": 138.14, "end": 138.48},
                {"text": "(be", "start": 138.48, "end": 138.83},
                {"text": "wise)", "start": 138.83, "end": 139.17},
            ],
            "start": 136.07,
            "end": 139.17,
        },
        {
            "words": [
                {"text": "Your", "start": 139.17, "end": 139.67},
                {"text": "mind", "start": 139.67, "end": 140.17},
                {"text": "is", "start": 140.17, "end": 140.68},
                {"text": "in", "start": 140.68, "end": 141.18},
                {"text": "disturbia", "start": 141.18, "end": 141.68},
            ],
            "start": 139.17,
            "end": 141.68,
        },
        {
            "words": [
                {"text": "It's", "start": 141.68, "end": 142.02},
                {"text": "like", "start": 142.02, "end": 142.35},
                {"text": "the", "start": 142.35, "end": 142.69},
                {"text": "darkness", "start": 142.69, "end": 143.02},
                {"text": "is", "start": 143.02, "end": 143.36},
                {"text": "the", "start": 143.36, "end": 143.69},
                {"text": "light", "start": 143.69, "end": 144.03},
            ],
            "start": 141.68,
            "end": 144.03,
        },
        {
            "words": [
                {"text": "Disturbia,", "start": 144.03, "end": 144.56},
                {"text": "am", "start": 144.56, "end": 145.09},
                {"text": "I", "start": 145.09, "end": 145.62},
                {"text": "scaring", "start": 145.62, "end": 146.14},
                {"text": "you", "start": 146.14, "end": 146.67},
                {"text": "tonight?", "start": 146.67, "end": 147.2},
                {"text": "(Oh)", "start": 147.2, "end": 147.73},
            ],
            "start": 144.03,
            "end": 147.73,
        },
        {
            "words": [
                {"text": "Disturbia,", "start": 147.73, "end": 148.12},
                {"text": "ain't", "start": 148.12, "end": 148.52},
                {"text": "used", "start": 148.52, "end": 148.91},
                {"text": "to", "start": 148.91, "end": 149.31},
                {"text": "what", "start": 149.31, "end": 149.7},
                {"text": "you", "start": 149.7, "end": 150.1},
                {"text": "like", "start": 150.1, "end": 150.5},
                {"text": "(what", "start": 150.5, "end": 150.89},
                {"text": "you", "start": 150.89, "end": 151.28},
                {"text": "like)", "start": 151.28, "end": 151.68},
            ],
            "start": 147.73,
            "end": 151.68,
        },
        {
            "words": [
                {"text": "Disturbia,", "start": 151.68, "end": 153.57},
                {"text": "disturbia", "start": 153.57, "end": 155.47},
            ],
            "start": 151.68,
            "end": 155.47,
        },
        {
            "words": [
                {"text": "Bum", "start": 155.47, "end": 156.02},
                {"text": "bum", "start": 156.02, "end": 156.57},
                {"text": "be-dum,", "start": 156.57, "end": 157.12},
                {"text": "bum", "start": 157.12, "end": 157.67},
                {"text": "bum", "start": 157.67, "end": 158.22},
                {"text": "be-dum", "start": 158.22, "end": 158.77},
                {"text": "bum", "start": 158.77, "end": 159.32},
            ],
            "start": 155.47,
            "end": 159.32,
        },
        {
            "words": [
                {"text": "Bum", "start": 159.32, "end": 159.87},
                {"text": "bum", "start": 159.87, "end": 160.42},
                {"text": "be-dum,", "start": 160.42, "end": 160.97},
                {"text": "bum", "start": 160.97, "end": 161.53},
                {"text": "bum", "start": 161.53, "end": 162.08},
                {"text": "be-dum", "start": 162.08, "end": 162.63},
                {"text": "bum", "start": 162.63, "end": 163.18},
            ],
            "start": 159.32,
            "end": 163.18,
        },
        {
            "words": [
                {"text": "Bum", "start": 163.18, "end": 163.7},
                {"text": "bum", "start": 163.7, "end": 164.22},
                {"text": "be-dum,", "start": 164.22, "end": 164.73},
                {"text": "bum", "start": 164.73, "end": 165.25},
                {"text": "bum", "start": 165.25, "end": 165.77},
                {"text": "be-dum", "start": 165.77, "end": 166.28},
                {"text": "bum", "start": 166.28, "end": 166.8},
                {"text": "(disturbia)", "start": 166.8, "end": 167.32},
            ],
            "start": 163.18,
            "end": 167.32,
        },
        {
            "words": [
                {"text": "Bum", "start": 167.32, "end": 167.8},
                {"text": "bum", "start": 167.8, "end": 168.28},
                {"text": "be-dum,", "start": 168.28, "end": 168.76},
                {"text": "bum", "start": 168.76, "end": 169.24},
                {"text": "bum", "start": 169.24, "end": 169.72},
                {"text": "be-dum", "start": 169.72, "end": 170.2},
                {"text": "bum", "start": 170.2, "end": 170.68},
                {"text": "(oh-oh)", "start": 170.68, "end": 171.16},
            ],
            "start": 167.32,
            "end": 171.16,
        },
        {
            "words": [
                {"text": "Release", "start": 171.16, "end": 171.74},
                {"text": "me", "start": 171.92, "end": 172.3},
                {"text": "from", "start": 172.38, "end": 172.86},
                {"text": "this", "start": 172.92, "end": 173.18},
                {"text": "curse", "start": 173.18, "end": 173.83},
                {"text": "I'm", "start": 173.83, "end": 174.48},
                {"text": "in", "start": 174.48, "end": 174.66},
            ],
            "start": 171.16,
            "end": 174.66,
        },
        {
            "words": [
                {"text": "Trying", "start": 175.1, "end": 175.58},
                {"text": "to", "start": 175.62, "end": 175.88},
                {"text": "maintain,", "start": 175.92, "end": 176.8},
                {"text": "but", "start": 176.84, "end": 177.08},
                {"text": "I'm", "start": 177.28, "end": 177.5},
                {"text": "struggling", "start": 177.52, "end": 179.07},
            ],
            "start": 175.1,
            "end": 179.07,
        },
        {
            "words": [
                {"text": "If", "start": 179.57, "end": 179.67},
                {"text": "you", "start": 179.73, "end": 179.87},
                {"text": "can't", "start": 179.99, "end": 180.69},
                {"text": "go,", "start": 180.77, "end": 181.19},
                {"text": "oh-oh-oh-oh-oh", "start": 181.19, "end": 182.83},
            ],
            "start": 179.57,
            "end": 182.83,
        },
        {
            "words": [
                {"text": "I", "start": 182.83, "end": 183.09},
                {"text": "think", "start": 183.15, "end": 183.43},
                {"text": "I'm", "start": 183.47, "end": 183.55},
                {"text": "gonna", "start": 183.61, "end": 183.93},
                {"text": "ah-ah-ah-ah-ah", "start": 183.93, "end": 185.76},
            ],
            "start": 182.83,
            "end": 185.76,
        },
        {
            "words": [
                {"text": "Put", "start": 185.76, "end": 186.12},
                {"text": "on", "start": 186.12, "end": 186.48},
                {"text": "your", "start": 186.48, "end": 186.84},
                {"text": "brake", "start": 186.84, "end": 187.2},
                {"text": "lights", "start": 187.2, "end": 187.56},
            ],
            "start": 185.76,
            "end": 187.56,
        },
        {
            "words": [
                {"text": "You're", "start": 187.56, "end": 187.79},
                {"text": "in", "start": 187.79, "end": 187.85},
                {"text": "the", "start": 187.91, "end": 187.97},
                {"text": "city", "start": 188.07, "end": 188.67},
                {"text": "of", "start": 188.67, "end": 188.88},
                {"text": "wonder", "start": 188.88, "end": 189.09},
                {"text": "(woo,", "start": 189.09, "end": 189.3},
                {"text": "yeah)", "start": 189.3, "end": 189.51},
            ],
            "start": 187.56,
            "end": 189.51,
        },
        {
            "words": [
                {"text": "Ain't", "start": 189.51, "end": 189.98},
                {"text": "gon'", "start": 189.98, "end": 190.45},
                {"text": "play", "start": 190.45, "end": 190.92},
                {"text": "nice", "start": 190.92, "end": 191.39},
            ],
            "start": 189.51,
            "end": 191.39,
        },
        {
            "words": [
                {"text": "Watch", "start": 191.39, "end": 191.68},
                {"text": "out,", "start": 191.68, "end": 191.97},
                {"text": "you", "start": 191.97, "end": 192.26},
                {"text": "might", "start": 192.26, "end": 192.56},
                {"text": "just", "start": 192.56, "end": 192.85},
                {"text": "go", "start": 192.85, "end": 193.14},
                {"text": "under", "start": 193.14, "end": 193.43},
            ],
            "start": 191.39,
            "end": 193.43,
        },
        {
            "words": [
                {"text": "Better", "start": 193.43, "end": 194.15},
                {"text": "think", "start": 194.15, "end": 194.87},
                {"text": "twice", "start": 194.87, "end": 195.05},
                {"text": "(better", "start": 195.05, "end": 195.07},
                {"text": "think", "start": 195.07, "end": 195.1},
                {"text": "twice)", "start": 195.1, "end": 195.12},
            ],
            "start": 193.43,
            "end": 195.12,
        },
        {
            "words": [
                {"text": "Your", "start": 195.12, "end": 195.46},
                {"text": "train", "start": 195.46, "end": 195.79},
                {"text": "of", "start": 195.79, "end": 196.13},
                {"text": "thought", "start": 196.13, "end": 196.46},
                {"text": "will", "start": 196.46, "end": 196.8},
                {"text": "be", "start": 196.8, "end": 197.13},
                {"text": "altered", "start": 197.13, "end": 197.47},
            ],
            "start": 195.12,
            "end": 197.47,
        },
        {
            "words": [
                {"text": "So", "start": 197.47, "end": 197.71},
                {"text": "if", "start": 197.71, "end": 197.96},
                {"text": "you", "start": 197.96, "end": 198.21},
                {"text": "must", "start": 198.21, "end": 198.46},
                {"text": "falter,", "start": 198.46, "end": 198.71},
                {"text": "be", "start": 198.71, "end": 198.96},
                {"text": "wise", "start": 198.96, "end": 199.22},
                {"text": "(if", "start": 199.22, "end": 199.47},
                {"text": "you", "start": 199.47, "end": 199.72},
                {"text": "must", "start": 199.72, "end": 199.97},
                {"text": "falter,", "start": 199.97, "end": 200.22},
                {"text": "be", "start": 200.22, "end": 200.47},
                {"text": "wise)", "start": 200.47, "end": 200.72},
            ],
            "start": 197.47,
            "end": 200.72,
        },
        {
            "words": [
                {"text": "Your", "start": 200.72, "end": 201.16},
                {"text": "mind", "start": 201.16, "end": 201.6},
                {"text": "is", "start": 201.6, "end": 202.05},
                {"text": "in", "start": 202.05, "end": 202.49},
                {"text": "disturbia", "start": 202.49, "end": 202.93},
            ],
            "start": 200.72,
            "end": 202.93,
        },
        {
            "words": [
                {"text": "It's", "start": 202.93, "end": 203.01},
                {"text": "like", "start": 203.03, "end": 203.17},
                {"text": "the", "start": 203.19, "end": 203.33},
                {"text": "darkness", "start": 203.33, "end": 203.67},
                {"text": "is", "start": 203.67, "end": 204.0},
                {"text": "the", "start": 204.0, "end": 204.34},
                {"text": "light", "start": 204.34, "end": 204.67},
                {"text": "(ah,", "start": 204.67, "end": 205.0},
                {"text": "yeah)", "start": 205.0, "end": 205.34},
            ],
            "start": 202.93,
            "end": 205.34,
        },
        {
            "words": [
                {"text": "Disturbia,", "start": 205.34, "end": 205.84},
                {"text": "am", "start": 205.84, "end": 206.34},
                {"text": "I", "start": 206.34, "end": 206.84},
                {"text": "scaring", "start": 206.84, "end": 207.34},
                {"text": "you", "start": 207.34, "end": 207.83},
                {"text": "tonight?", "start": 207.83, "end": 208.33},
                {"text": "(Ah,", "start": 208.33, "end": 208.83},
                {"text": "yeah)", "start": 208.83, "end": 209.33},
            ],
            "start": 205.34,
            "end": 209.33,
        },
        {
            "words": [
                {"text": "Disturbia,", "start": 209.33, "end": 209.74},
                {"text": "ain't", "start": 209.74, "end": 210.14},
                {"text": "used", "start": 210.14, "end": 210.55},
                {"text": "to", "start": 210.55, "end": 210.96},
                {"text": "what", "start": 210.96, "end": 211.36},
                {"text": "you", "start": 211.36, "end": 211.77},
                {"text": "like", "start": 211.77, "end": 212.18},
                {"text": "(disturbia,", "start": 212.18, "end": 212.58},
                {"text": "ah)", "start": 212.58, "end": 212.99},
            ],
            "start": 209.33,
            "end": 212.99,
        },
        {
            "words": [
                {"text": "Disturbia,", "start": 212.99, "end": 215.04},
                {"text": "disturbia", "start": 215.04, "end": 217.09},
            ],
            "start": 212.99,
            "end": 217.09,
        },
        {
            "words": [
                {"text": "Bum", "start": 217.09, "end": 217.55},
                {"text": "bum", "start": 217.55, "end": 218.01},
                {"text": "be-dum,", "start": 218.01, "end": 218.48},
                {"text": "bum", "start": 218.48, "end": 218.94},
                {"text": "bum", "start": 218.94, "end": 219.4},
                {"text": "be-dum", "start": 219.4, "end": 219.87},
                {"text": "bum", "start": 219.87, "end": 220.33},
                {"text": "(bum-ba-de-da-da)", "start": 220.33, "end": 220.79},
            ],
            "start": 217.09,
            "end": 220.79,
        },
        {
            "words": [
                {"text": "Bum", "start": 220.79, "end": 221.29},
                {"text": "bum", "start": 221.29, "end": 221.78},
                {"text": "be-dum,", "start": 221.78, "end": 222.28},
                {"text": "bum", "start": 222.28, "end": 222.77},
                {"text": "bum", "start": 222.77, "end": 223.27},
                {"text": "be-dum", "start": 223.27, "end": 223.77},
                {"text": "bum", "start": 223.77, "end": 224.26},
                {"text": "(bum-ba-de-da-da)", "start": 224.26, "end": 224.76},
            ],
            "start": 220.79,
            "end": 224.76,
        },
        {
            "words": [
                {"text": "Bum", "start": 224.76, "end": 225.23},
                {"text": "bum", "start": 225.23, "end": 225.71},
                {"text": "be-dum,", "start": 225.71, "end": 226.19},
                {"text": "bum", "start": 226.19, "end": 226.66},
                {"text": "bum", "start": 226.66, "end": 227.13},
                {"text": "be-dum", "start": 227.13, "end": 227.61},
                {"text": "bum", "start": 227.61, "end": 228.09},
                {"text": "(oh)", "start": 228.09, "end": 228.56},
            ],
            "start": 224.76,
            "end": 228.56,
        },
        {
            "words": [
                {"text": "Bum", "start": 228.56, "end": 229.17},
                {"text": "bum", "start": 229.17, "end": 229.78},
                {"text": "be-dum,", "start": 229.78, "end": 230.39},
                {"text": "bum", "start": 230.39, "end": 231.0},
                {"text": "bum", "start": 231.0, "end": 231.6},
                {"text": "be-dum", "start": 231.6, "end": 232.21},
                {"text": "bum", "start": 232.21, "end": 232.82},
                {"text": "(oh)", "start": 232.82, "end": 233.43},
            ],
            "start": 228.56,
            "end": 233.43,
        },
    ]
}


def format_seconds(seconds: float) -> str:
    # convert seconds to minutes, seconds and milliseconds
    minutes = int(seconds / 60)
    _seconds = int(seconds % 60)
    milliseconds = int((seconds % 1) * 1000)
    return f"{minutes:02d}:{_seconds:02d}.{milliseconds:03d}"


@dataclass_json
@dataclass
class Word:
    text: str
    start: Optional[float]
    end: Optional[float]

    @property
    def clean_text(self):
        return CLEAN_TEXT_REGEX.sub("", self.text).lower().strip()


@dataclass_json
@dataclass
class Line:
    words: list[Word]
    start: float
    end: Optional[float]

    @property
    def text(self):
        return " ".join([word.text for word in self.words])

    def __str__(self):
        words = " ".join([word.text for word in self.words])

        if self.end is None:
            return f"[{format_seconds(self.start)}] {words}"

        return f"[{format_seconds(self.start)} - {format_seconds(self.end)}] {words}"

    @classmethod
    def from_words(cls, words: list[Word]):
        start = words[0].start if words else None
        end = words[-1].end if words else None
        return cls(words, start, end)


@dataclass_json
@dataclass
class Lyrics:
    lines: list[Line]

    @property
    def text(self):
        return " ".join([line.text for line in self.lines])

    @property
    def words(self):
        words = []
        for line in self.lines:
            words.extend(line.words)
        return words

    def __str__(self):
        return "\n".join([str(line) for line in self.lines])


class BaseLyricsExtractor:
    def extract(self, name, audio_file) -> Lyrics:
        raise NotImplementedError

    @classmethod
    def get_audio_duration(cls, audio_file) -> float:
        with sf.SoundFile(audio_file) as f:
            return f.frames / f.samplerate


class NetEaseLyricsExtractor(BaseLyricsExtractor):
    def extract(self, name, audio_file) -> Lyrics:
        if not name:
            raise ValueError("name is required")

        lines = []

        song = self.get_song_by_name(name)
        if not song:
            return Lyrics(lines=lines)

        lyrics_text = self.get_lyrics_by_song_id(song["id"])

        for line in lyrics_text.splitlines():
            # [00:00.000]...
            start, end, text = self._extract_start_end_text(line)

            words = []
            for word in text.split():
                words.append(Word(word, None, None))

            lines.append(Line(words, start, end))

        return Lyrics(lines=lines)

    @classmethod
    def _extract_start_end_text(
        cls, text
    ) -> Tuple[Optional[float], Optional[float], str]:
        start = None
        end = None
        if text.startswith("["):
            text = text[1:]
            time_text, text = text.split("]", 1)
            minutes, seconds = time_text.split(":")
            seconds, milliseconds = seconds.split(".")
            start = int(minutes) * 60 + int(seconds) + int(milliseconds) / 1000

        return start, end, text

    @classmethod
    def search_songs_by_name(cls, name):
        response = requests.get(
            f"http://music.163.com/api/search/get/?csrf_token=hlpretag=&hlposttag=&s={name}&type=1&offset=0&total=true&limit=6"
        )
        response.raise_for_status()
        return response.json()["result"]["songs"]

    @classmethod
    def get_song_by_name(cls, name):
        songs = cls.search_songs_by_name(name)
        return songs[0] if songs else None

    @classmethod
    def get_lyrics_by_song_id(cls, song_id):
        response = requests.get(
            f"http://music.163.com/api/song/lyric?os=pc&id={song_id}&lv=-1&kv=-1&tv=-1"
        )
        response.raise_for_status()
        return response.json()["lrc"]["lyric"]


class SpotifyLyricsExtractor(BaseLyricsExtractor):
    SP_DC = "AQBV2NIbzmRB5mrVhTPwkR24T7Tbcl1mHI7KhCYJnzVqqXNUxNmQ4gI7el760SpyJfJSyyDbdLUdG0tqs0V_jeemqmmzSyekBHzT42K4-LDvn6aBVYtGCQYjjejFNZ1LRWTLVtgh_TmSvpKYDl6N4TvuezlpL-9z"
    TOKEN_URL = "https://open.spotify.com/get_access_token?reason=transport&productType=web_player"
    LYRICS_URL = "https://spclient.wg.spotify.com/color-lyrics/v2/track/{song_id}?format=json&market=from_token"
    SEARCH_URL = 'https://api-partner.spotify.com/pathfinder/v1/query?operationName=searchDesktop&variables={{"searchTerm":"{name}","offset":0,"limit":10,"numberOfTopResults":5,"includeAudiobooks":true}}&extensions={{"persistedQuery":{{"version":1,"sha256Hash":"1d3a8f81abf4f33f49d1e389ed0956761af669eedb62a050c6c7bce5c66070bb"}}}}'

    def __init__(self, sp_dc=None):
        self.sp_dc = sp_dc or self.SP_DC
        self._cached_token = None
        self._cached_token_expires_at = None

    def extract(self, name, audio_file) -> Lyrics:
        # return Lyrics.from_dict(spotify_lyrics_data)

        song = self.get_song_by_name(name)
        lyrics = self.get_lyrics_by_song_id(song["id"])
        lines = []

        for line in lyrics:
            start = int(line["startTimeMs"]) / 1000
            end = int(line["endTimeMs"]) / 1000 if line["endTimeMs"] != "0" else None
            text = line["words"]

            words = []
            for word in text.split():
                words.append(Word(word, None, None))

            lines.append(Line(words, start, end))

        return Lyrics(lines=lines)

    def _get_token(self):
        if (
            self._cached_token
            and self._cached_token_expires_at
            and self._cached_token_expires_at > time.time()
        ):
            return self._cached_token, self._cached_token_expires_at

        response = requests.get(
            self.TOKEN_URL,
            headers={
                "User-Agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36",
                "App-platform": "WebPlayer",
                "content-type": "text/html; charset=utf-8",
                "cookie": f"sp_dc={self.sp_dc};",
            },
        )
        response.raise_for_status()

        token = response.json()["accessToken"]
        expires_at = int(response.json()["accessTokenExpirationTimestampMs"]) / 1000

        self._cached_token = token
        self._cached_token_expires_at = expires_at

        return token, expires_at

    def get_lyrics_by_song_id(self, song_id):
        token, expires_at = self._get_token()
        response = requests.get(
            self.LYRICS_URL.format(song_id=song_id),
            headers={
                "User-Agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36",
                "App-platform": "WebPlayer",
                "authorization": f"Bearer {token}",
            },
        )
        response.raise_for_status()

        data = response.json()

        if not data["lyrics"]["syncType"] == "LINE_SYNCED":
            raise ValueError("Lyrics are not LINE_SYNCED")

        return data["lyrics"]["lines"]

    def search_songs_by_name(self, name):
        token, expires_at = self._get_token()
        response = requests.get(
            self.SEARCH_URL.format(name=name),
            headers={
                "User-Agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36",
                "App-platform": "WebPlayer",
                "authorization": f"Bearer {token}",
            },
        )
        response.raise_for_status()

        return response.json()["data"]["searchV2"]["tracksV2"]["items"]

    def get_song_by_name(self, name):
        songs = self.search_songs_by_name(name)
        return songs[0]["item"]["data"] if songs else None


import logging

logging.basicConfig()
logging.getLogger().setLevel(logging.DEBUG)


class WhisperLyricsExtractor(BaseLyricsExtractor):
    def extract(self, name, audio_path) -> Lyrics:
        device = "cpu"
        batch_size = 4
        compute_type = "int8"

        # vad_model = load_vad_model(
        #    torch.device(device), 0.500, 0.363, use_auth_token=None
        # )

        if not audio_path.endswith(".wav"):
            audio_basename = os.path.splitext(os.path.basename(audio_path))[0]
            input_audio_path = os.path.join(
                os.path.dirname(audio_path), audio_basename + ".wav"
            )
            ffmpeg.input(audio_path, threads=0).output(
                input_audio_path, ac=1, ar=SAMPLE_RATE
            ).run(cmd=["ffmpeg"])

        # transcribe with original whisper
        # model = whisper.load_model("small", device)
        # result = transcribe_with_vad(model, audio_path, vad_model)

        model = whisperx.load_model(
            "small", device, compute_type=compute_type, language="de"
        )

        print("LOADED MODEL")

        audio = whisperx.load_audio(audio_path)
        result = model.transcribe(audio, batch_size=batch_size, language="de")

        print("TRANSCRIBED")

        # load alignment model and metadata
        model_a, metadata = whisperx.load_align_model(
            language_code=result["language"], device=device
        )

        print(result["segments"])

        # align whisper output
        result_aligned = whisperx.align(
            result["segments"], model_a, metadata, audio_path, device
        )
        all_words = result_aligned["word_segments"]

        lines = []

        for line in result_aligned["segments"]:
            start = line["start"]
            end = line["end"]

            words = get_words_for_time_range(
                [Word(word["text"], word["start"], word["end"]) for word in all_words],
                None,
                start,
                end,
            )
            lines.append(Line(words, start, end))

        return Lyrics(lines=lines)


def get_words_for_time_range(words, lyrics: Lyrics, start, end):
    words = words or [word for line in lyrics.lines for word in line.words]
    results = []
    for word in words:
        if word.start and word.end and word.start >= start and word.end <= end:
            results.append(word)

        elif word.start and not word.end and start <= word.start <= end:
            results.append(word)

    return results


def merge_lyrics(primary_lyrics, secondary_lyrics):
    primary_lyrics = deepcopy(primary_lyrics)
    secondary_lyrics = deepcopy(secondary_lyrics)

    # remove ♪ from spotify
    for line in primary_lyrics.lines:
        for i, word in enumerate(line.words):
            if word.text == "♪":
                del line.words[i]

    primary_words = primary_lyrics.words
    secondary_words = secondary_lyrics.words

    # correct word start and end

    from difflib import SequenceMatcher

    s = SequenceMatcher(
        None,
        [word.clean_text for word in primary_words],
        [word.clean_text for word in secondary_words],
    )

    prev_a = 0
    prev_b = 0

    for block in s.get_matching_blocks():
        spotify_not_matched_words = primary_words[prev_a : block.a]
        whisper_not_matched_words = secondary_words[prev_b : block.b]

        if len(spotify_not_matched_words) == len(whisper_not_matched_words):
            for spotify_word, whisper_word in zip(
                spotify_not_matched_words, whisper_not_matched_words
            ):
                spotify_word.start = whisper_word.start
                spotify_word.end = whisper_word.end

        else:
            spotify_words_count = len(spotify_not_matched_words)

            if not whisper_not_matched_words:
                # TODO: fix when prev_b - 1 is already corrected
                start = secondary_words[prev_b - 1].end
                end = secondary_words[prev_b].start

            else:
                start = whisper_not_matched_words[0].start
                end = whisper_not_matched_words[-1].end

            for i, word in enumerate(spotify_not_matched_words):
                word.start = start + (end - start) * (i / spotify_words_count)
                word.end = start + (end - start) * ((i + 1) / spotify_words_count)

            print(spotify_not_matched_words)
            print(whisper_not_matched_words)
            print("\n\n")

        spotify_block_words = primary_words[block.a : block.a + block.size]
        whisper_block_words = secondary_words[block.b : block.b + block.size]

        for spotify_word, whisper_word in zip(spotify_block_words, whisper_block_words):
            spotify_word.start = whisper_word.start
            spotify_word.end = whisper_word.end

        prev_a = block.a + block.size
        prev_b = block.b + block.size

    # for word1, word2 in zip(primary_words[:15], secondary_words[:15]):
    #    print(word1)
    #    print(word2)
    #    print("\n\n")

    for line in primary_lyrics.lines:
        # line.words = sorted(line.words, key=lambda x: x.start)

        if line.words:
            line.start = line.words[0].start
            line.end = line.words[-1].end

    return primary_lyrics

    # correct offset (spotify as source of truth)

    offset_median = statistics.median(
        [
            line.start - line.words[0].start
            for line in primary_lyrics.lines
            if line.start and line.words and line.words[0].start
        ]
    )

    for i, line in enumerate(primary_lyrics.lines):
        line_offset = offset_median

        if line.words and line.words[0].start:
            line_offset = line.start - line.words[0].start

        # adjust offset if something is clearly wrong

        if abs(abs(line_offset) - abs(offset_median)) > 1:
            for word in line.words:
                if word.start:
                    word.start = round(word.start + line_offset - offset_median, 2)

                if word.end:
                    word.end = round(word.end + line_offset - offset_median, 2)

        # correct line start amd end time

        if line.words and line.words[0].start:
            line.start = line.words[0].start

        elif line.start:
            line.start = line.start - line_offset

    # offsets have to be corrected upfront, otherwise the following code will not work

    for i, line in enumerate(primary_lyrics.lines):
        if not line.end and line.words:
            line.end = line.words[-1].end
            if not line.end and i + 1 < len(primary_lyrics.lines):
                line.end = primary_lyrics.lines[i + 1].start

        elif not line.end and line.start:
            line.end = line.start

        # correct word start and end if not present

        missing_time_words = []

        for j, word in enumerate(line.words):
            # if first word in line, start time is line start time
            if not word.start and line.start and j == 0:
                word.start = line.start

            # if word start time is not present, use previous word end time
            elif not word.start and j > 0 and line.words[j - 1].end:
                word.start = line.words[j - 1].end

            # if last word and no end time, use line end time
            if not word.end and line.end and j == len(line.words) - 1:
                word.end = line.end

            # if word end time is not present, use next word start time
            elif not word.end and j < len(line.words) - 1 and line.words[j + 1].start:
                word.end = line.words[j + 1].start

            if not word.start or not word.end:
                missing_time_words.append(word)

            # correct missing time words
            if (word.end or j == len(line.words) - 1) and missing_time_words:
                start_time = missing_time_words[0].start or line.start
                end_time = word.end or line.end
                time_diff = end_time - start_time
                word_count = len(missing_time_words)
                time_per_word = time_diff / word_count

                for m, missing_word in enumerate(missing_time_words):
                    missing_word.start = round(start_time + time_per_word * m, 2)
                    missing_word.end = round(start_time + time_per_word * (m + 1), 2)

                missing_time_words = []

    return primary_lyrics


if __name__ == "__main__":
    # lyrics = NetEaseLyricsExtractor().extract("In da club", "club.mp3")
    # spotify_lyrics = SpotifyLyricsExtractor().extract("Disturbia", "data/disturbia.mp3")
    # whisper_lyrics = WhisperLyricsExtractor().extract("Disturbia", "data/separated/htdemucs/disturbia/vocals.wav")

    spotify_lyrics = Lyrics.from_dict(spotify_lyrics_data)
    whisper_lyrics = Lyrics.from_dict(whisper_lyrics_data)

    merged = merge_lyrics(spotify_lyrics, whisper_lyrics)

    print(merged)
